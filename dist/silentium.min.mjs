const t=t=>null!=t;function e(t){return null!==t&&"object"==typeof t&&"to"in t&&"function"==typeof t.to}function s(t){return null!==t&&"object"==typeof t&&"destroy"in t&&"function"==typeof t.destroy}function r(t){return null!==t&&"object"==typeof t&&"destroyed"in t&&"function"==typeof t.destroy}function n(t){return null!==t&&"object"==typeof t&&"use"in t&&"function"==typeof t.use}function i(t){return new o(t)}class o{constructor(t){this.base=t}destroy(){return s(this.base)&&this.base.destroy(),this}}var a=Object.defineProperty,u=(t,e,s)=>((t,e,s)=>e in t?a(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,e+"",s);function h(){return new c}class c{constructor(){u(this,"destructors",[])}add(t){return s(t)&&this.destructors.push(t),t}destroy(){return this.destructors.forEach((t=>t.destroy())),this.destructors.length=0,this}}function l(t,e){if("function"!=typeof t)throw new Error(`${e}: is not function`)}function b(t,s){if(!e(t))throw new Error(`${s}: is not message`)}function p(t,e){if(!n(t))throw new Error(`${e}: is not transport`)}var f=Object.defineProperty,d=(t,e,s)=>((t,e,s)=>e in t?f(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,e+"",s);function w(t){return new y(t)}class y{constructor(t){this.executor=t,d(this,"mbDestructor"),l(t,"Message: executor")}to(t){return this.mbDestructor=this.executor(t),this}destroy(){return"function"==typeof this.mbDestructor&&this.mbDestructor?.(),this}}function m(t){return new $(t)}class ${constructor(t){this.executor=t,l(t,"Transport: transport executor")}use(t){return this.executor(t),this}}function v(t){return new g(t)}class g{constructor(t){this.executor=t,l(t,"TransportMessage: transport executor")}use(t){return this.executor(t)}}function P(t,...e){return new T(t,e)}class T{constructor(t,e=[],s){this.executor=t,this.args=e,this._child=s,l(t,"TransportParent: executor")}use(t){if(void 0===this._child)throw new Error("no base transport");return this.executor.call(this._child,t,...this.args),this}child(t,...e){return new T(this.executor,[...this.args,...e],t)}}var j=Object.defineProperty,O=(t,e,s)=>((t,e,s)=>e in t?j(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);function E(t){return new x(t)}class x{constructor(t){this.$base=t,O(this,"destroyed",!1),O(this,"transport",P((function(t,e){e.destroyed||this.use(t)}),this)),b(t,"Local: $base")}to(t){return this.$base.to(this.transport.child(t)),this}destroy(){return this.destroyed=!0,this}}function M(t){return w((e=>{e.use(t())}))}function V(t){return new C(t)}class C{constructor(t){this.value=t}to(t){return t.use(this.value),this}}function z(t){return new A(t)}class A{constructor(t){this.base=t}wait(t){return void 0!==this.base&&t.to(this.base),this}}function k(){return new F}class F{use(){return this}}var S=Object.defineProperty,B=(t,e,s)=>((t,e,s)=>e in t?S(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);function D(...t){return new I(...t)}class I{constructor(...t){B(this,"known"),B(this,"filled",new Set),B(this,"$messages"),B(this,"result",[]),B(this,"transport",P((function(t,e,s){var r,n;e.filled.add(s),e.result[parseInt(s)]=t,r=e.filled,n=e.known,r.size>0&&r.size===n.size&&this.use(e.result)}),this)),this.known=new Set(Object.keys(t)),this.$messages=t}to(t){return Object.entries(this.$messages).forEach((([e,s])=>{b(s,"All: item"),s.to(this.transport.child(t,e))})),0===this.known.size&&t.use([]),this}}var N=Object.defineProperty,_=(t,e,s)=>((t,e,s)=>e in t?N(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,e+"",s);function L(...t){return new R(...t)}class R{constructor(...t){_(this,"$messages"),this.$messages=t}to(t){return this.$messages.forEach((e=>{b(e,"Any: item"),e.to(t)})),this}}var W=Object.defineProperty,q=(t,e,s)=>((t,e,s)=>e in t?W(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,e+"",s);function G(t,e){return new H(t,e)}class H{constructor(t,e){this.$base=t,this.applier=e,q(this,"transport",P((function(t,e){this.use(e.applier(t))}),this)),b(t,"Applied: base")}to(t){return this.$base.to(this.transport.child(t)),this}}function J(t,e){return G(t,(t=>e(...t)))}function K(t,e,s){return new Q(t,e,s)}class Q{constructor(t,e,s){this.$base=t,this.errorMessage=e,this.errorOriginal=s,b(t,"Catch: base"),p(e,"Catch: errorMessage"),void 0!==s&&p(s,"Catch: errorOriginal")}to(t){try{this.$base.to(t)}catch(t){t instanceof Error?this.errorMessage.use(t.message):this.errorMessage.use(String(t)),this.errorOriginal&&this.errorOriginal.use(t)}return this}}var U=Object.defineProperty,X=(t,e,s)=>((t,e,s)=>e in t?U(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);function Y(...t){return new Z(...t)}class Z{constructor(...t){X(this,"$messages"),X(this,"$latest"),X(this,"handleMessage",((t,e)=>{const s=this.$messages[t],r=this.$messages[t+1];s.to(this.oneMessageTransport.child(e,r,t))})),X(this,"oneMessageTransport",P((function(t,e,s,r){s||(e.$latest=t),e.$latest&&this.use(e.$latest),s&&!e.$latest&&e.handleMessage(r+1,this)}),this)),this.$messages=t}to(t){return this.handleMessage(0,t),this}}function tt(t,e){return new et(t,e)}class et{constructor(t,e){this.$base=t,this.applier=e,b(t,"ExecutorApplied: base")}to(t){const e=this.applier(t.use.bind(t));return this.$base.to(m(e)),this}}var st=Object.defineProperty,rt=(t,e,s)=>((t,e,s)=>e in t?st(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,e+"",s);function nt(t,e,s){return new it(t,e,s)}class it{constructor(t,e,s){this.$base=t,this.predicate=e,this.defaultValue=s,rt(this,"parent",P((function(t,e){e.predicate(t)?this.use(t):void 0!==e.defaultValue&&this.use(e.defaultValue)}),this))}to(t){return this.$base.to(this.parent.child(t)),this}}var ot=Object.defineProperty,at=(t,e,s)=>((t,e,s)=>e in t?ot(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);function ut(t,e,s,r){return new ht(t,e,s,r)}class ht{constructor(t,e,s,r){this.$emitter=t,this.$eventName=e,this.$subscribeMethod=s,this.$unsubscribeMethod=r,at(this,"lastTransport",null),at(this,"handler",(t=>{this.lastTransport&&this.lastTransport.use(t)})),at(this,"parent",P((function([t,e,s],r){r.lastTransport=this,t?.[s]&&t[s](e,r.handler)}),this))}to(t){return D(this.$emitter,this.$eventName,this.$subscribeMethod).to(this.parent.child(t)),this}destroy(){return this.lastTransport=null,this.$unsubscribeMethod?(D(this.$emitter,this.$eventName,this.$unsubscribeMethod).to(m((([t,e,s])=>{t?.[s]?.(e,this.handler)}))),this):this}}function ct(t,e){return new lt(t,e)}class lt{constructor(t,e){this.p=t,this.error=e}to(t){return this.p.then((e=>{t.use(e)})).catch((t=>{this.error?.use(t)})),this}}var bt=Object.defineProperty,pt=(t,e,s)=>((t,e,s)=>e in t?bt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);function ft(t){return new dt(t)}class dt{constructor(e){this.v=e,pt(this,"lateTransport",null),pt(this,"notify",(e=>{t(e)&&this.lateTransport&&this.lateTransport.use(e)}))}to(t){if(this.lateTransport)throw new Error("Late component gets new transport, when another was already connected!");return this.lateTransport=t,this.notify(this.v),this}use(t){return this.notify(t),this}}var wt=Object.defineProperty,yt=(t,e,s)=>((t,e,s)=>e in t?wt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);function mt(t){return new $t(t)}class $t{constructor(t){this.$base=t,yt(this,"isFilled",!1),yt(this,"parent",P((function(t,e){e.isFilled||(e.isFilled=!0,this.use(t))}),this))}to(t){return this.$base.to(this.parent.child(t)),this}}var vt=Object.defineProperty,gt=(t,e,s)=>((t,e,s)=>e in t?vt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);class Pt{constructor(){gt(this,"transports"),gt(this,"innerTransport"),this.transports=new Set,this.innerTransport=m((t=>{this.transports.forEach((e=>{r(e)&&e.destroyed()?this.transports.delete(e):e.use(t)}))}))}transport(){return this.innerTransport}size(){return this.transports.size}has(t){return this.transports.has(t)}add(t){return this.transports.add(t),this}remove(t){return this.transports.delete(t),this}destroy(){return this.transports.forEach((t=>{this.remove(t)})),this}}var Tt=Object.defineProperty,jt=(t,e,s)=>((t,e,s)=>e in t?Tt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);function Ot(t,e=!1){return new Et(t,e)}class Et{constructor(t,e=!1){this.$base=t,this.stateless=e,jt(this,"transportPool",new Pt),jt(this,"lastValue"),jt(this,"calls",ft()),jt(this,"firstCallTransport",m((t=>{this.lastValue=t,this.transportPool.transport().use(t)}))),mt(this.calls).to(m((()=>{this.$base.to(this.firstCallTransport)})))}to(e){return this.calls.use(1),this.stateless||!t(this.lastValue)||this.transportPool.has(e)||e.use(this.lastValue),this.transportPool.add(e),this}use(t){return this.calls.use(1),this.lastValue=t,this.transportPool.transport().use(t),this}touched(){this.calls.use(1)}pool(){return this.transportPool}destroy(){return this.transportPool.destroy()}}var xt=Object.defineProperty,Mt=(t,e,s)=>((t,e,s)=>e in t?xt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,e+"",s);function Vt(t,e=!1){return new Ct(t,e)}class Ct{constructor(t,e=!1){this.$base=t,Mt(this,"$sharedBase"),this.$sharedBase=Ot(this.$base,e)}to(t){return this.$sharedBase.to(t),this}use(t){return this.$sharedBase.touched(),this.$base.use(t),this}}var zt=Object.defineProperty,At=(t,e,s)=>((t,e,s)=>e in t?zt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,e+"",s);function kt(t,e=null){return new Ft(t,e)}class Ft{constructor(t,e=null){this.$base=t,this.theValue=e,At(this,"touched",!1)}ensureTouched(){this.touched||this.$base.to(m((t=>{this.theValue=t}))),this.touched=!0}[Symbol.toPrimitive](){return this.ensureTouched(),this.theValue}primitive(){return this.ensureTouched(),this.theValue}primitiveWithException(){if(this.ensureTouched(),null===this.theValue)throw new Error("Primitive value is null");return this.theValue}}var St=Object.defineProperty,Bt=(t,e,s)=>((t,e,s)=>e in t?St(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);function Dt(t){return new It(t)}class It{constructor(t){Bt(this,"$msg"),Bt(this,"primitive"),this.$msg=Vt(ft(t)),this.primitive=kt(this,t)}to(t){return this.$msg.to(t),this}use(t){return this.$msg.use(t),this}value(){return this.primitive}}var Nt=Object.defineProperty,_t=(t,e,s)=>((t,e,s)=>e in t?Nt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,e+"",s);function Lt(t,e){return new Rt(t,e)}class Rt{constructor(t,s){this.$base=t,this.$target=s,_t(this,"parent",P((function(t,s){const r=[];t.forEach((t=>{let n=t;e(n)||(n=V(n));const i=s.$target.use(n);r.push(i)})),D(...r).to(this)}),this))}to(t){return this.$base.to(this.parent.child(t)),this}}var Wt=Object.defineProperty,qt=(t,e,s)=>((t,e,s)=>e in t?Wt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);function Gt(t){return new Ht(t)}Gt.transport={};class Ht{constructor(t){this.$rpc=t,qt(this,"$result",Dt()),qt(this,"$error",Dt())}result(){return this.$rpc.to(m((t=>{const e=void 0===t.transport?Gt.transport.default:Gt.transport[t.transport]||Gt.transport.default;if(!e)throw new Error(`RPCImpl: Transport not found ${t.transport}`);t.result||(t.result=this.$result),t.error||(t.error=this.$error),e.use(t)}))),this.$result}error(){return this.$error}}function Jt(t){return m((e=>{if(!e.result)throw new Error("RPCChain did not find result in rpc message");t.to(e.result)}))}function Kt(t){const e=Dt();return Gt.transport[t]=e,w((t=>{e.to(t)}))}var Qt=Object.defineProperty,Ut=(t,e,s)=>((t,e,s)=>e in t?Qt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);function Xt(t){return new Yt(t)}class Yt{constructor(t){this.$base=t,Ut(this,"result",[]),Ut(this,"parent",P((function(t,e){e.result.push(t),this.use(e.result)}),this))}to(t){return this.$base.to(this.parent.child(t)),this}}var Zt=Object.defineProperty,te=(t,e,s)=>((t,e,s)=>e in t?Zt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,e+"",s);function ee(t){return new se(t)}class se{constructor(t){this.$base=t,te(this,"parent",P((function(t){t.forEach((t=>{this.use(t)}))})))}to(t){return this.$base.to(this.parent.child(t)),this}}function re(t,e){return new ne(t,e)}class ne{constructor(t,e){this.baseTransport=t,this.applier=e}use(t){return this.applier(this.baseTransport.use(t))}}function ie(t,e,s=0){return new oe(t,e,s)}class oe{constructor(t,e,s=0){this.baseTransport=t,this.args=e,this.startFromArgIndex=s}use(t){return this.baseTransport.use(function(t,e,s){const r=t.slice(0,s);for(;r.length<s;)r.push(void 0);return r.concat(e)}(t,this.args,this.startFromArgIndex))}}var ae=Object.defineProperty,ue=(t,e,s)=>((t,e,s)=>e in t?ae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,e+"",s);function he(t){return new ce(t)}class ce{constructor(t){this.baseTransport=t,ue(this,"destructors",[])}use(t){const e=this.baseTransport.use(t);return s(e)&&this.destructors.push(e),e}destroy(){return this.destructors.forEach((t=>t.destroy())),this}}export{D as All,I as AllImpl,L as Any,R as AnyImpl,G as Applied,J as AppliedDestructured,H as AppliedImpl,K as Catch,Q as CatchImpl,Y as Chain,Z as ChainImpl,h as DestroyContainer,c as DestroyContainerImpl,i as Destroyable,o as DestroyableImpl,tt as ExecutorApplied,et as ExecutorAppliedImpl,nt as Filtered,it as FilteredImpl,ut as FromEvent,ht as FromEventImpl,ct as FromPromise,lt as FromPromiseImpl,ft as Late,dt as LateImpl,Dt as LateShared,It as LateSharedImpl,E as Local,x as LocalImpl,Lt as Map,Rt as MapImpl,w as Message,y as MessageImpl,M as New,V as Of,C as OfImpl,mt as Once,$t as OnceImpl,kt as Primitive,Ft as PrimitiveImpl,Gt as RPC,Jt as RPCChain,Ht as RPCImpl,Kt as RPCOf,Xt as Sequence,Yt as SequenceImpl,Ot as Shared,Et as SharedImpl,Vt as SharedSource,Ct as SharedSourceImpl,ee as Stream,se as StreamImpl,m as Transport,re as TransportApplied,ne as TransportAppliedImpl,ie as TransportArgs,oe as TransportArgsImpl,he as TransportDestroyable,ce as TransportDestroyableImpl,$ as TransportImpl,v as TransportMessage,g as TransportMessageImpl,z as TransportOptional,A as TransportOptionalImpl,P as TransportParent,T as TransportParentImpl,Pt as TransportPool,k as Void,F as VoidImpl,l as ensureFunction,b as ensureMessage,p as ensureTransport,s as isDestroyable,r as isDestroyed,t as isFilled,e as isMessage,n as isTransport};
//# sourceMappingURL=silentium.min.mjs.map
