import{isFilled as e}from"src/helpers";import{DestroyFunc as s}from"src/base/DestroyFunc";import{Lazy as t}from"src/base";class r{constructor(e){this.deps=e}destroy(){return this.deps?.forEach((e=>{e instanceof r&&e.destroy()})),this}addDep(e){return this.deps?.push(e),this}}class i extends r{constructor(e){super(),this.destructor=e}destroy(){return this.destructor(),this}}class n{}class h extends n{constructor(e){super(),this.fn=e}give(e){return this.fn(e),this}}class a extends r{}class o extends a{constructor(e){super([e]),this.theValue=e}value(s){return e(this.theValue)&&s.give(this.theValue),this}}class u extends r{constructor(e){super(),this.buildFn=e}get(...e){return e.forEach((e=>{this.addDep(e)})),this.buildFn?.(...e)??new o(null)}}var l=Object.defineProperty,c=(e,s,t)=>((e,s,t)=>s in e?l(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t)(e,s+"",t);class d extends a{constructor(e){super([e]),this.valueFn=e,c(this,"mbDestructor")}value(e){return this.mbDestructor=this.valueFn(e),this}destroy(){return super.destroy(),this.mbDestructor?.(),this}}var v=Object.defineProperty,w=(e,s,t)=>((e,s,t)=>s in e?v(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t)(e,"symbol"!=typeof s?s+"":s,t);class b extends a{constructor(...e){super(e),w(this,"keysKnown"),w(this,"keysFilled",new Set),w(this,"infos"),this.infos=e,this.keysKnown=new Set(Object.keys(e))}value(e){const s={};return Object.entries(this.infos).forEach((([t,r])=>{this.keysKnown.add(t),r.value(new h((r=>{this.keysFilled.add(t),s[t]=r,this.isAllFilled()&&e.give(Object.values(s))})))})),this}isAllFilled(){return this.keysFilled.size>0&&this.keysFilled.size===this.keysKnown.size}}var p=Object.defineProperty,f=(e,s,t)=>((e,s,t)=>s in e?p(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t)(e,s+"",t);class y extends a{constructor(...e){super(e),f(this,"infos"),this.infos=e}value(e){return this.infos.forEach((s=>{s.value(e)})),this}}class g extends a{constructor(e,s){super([e]),this.baseSrc=e,this.applier=s}value(e){return this.baseSrc.value(new h((s=>{e.give(this.applier(s))}))),this}}var m=Object.defineProperty,S=(e,s,t)=>((e,s,t)=>s in e?m(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t)(e,s+"",t);class x extends a{constructor(...e){super(e),S(this,"theInfos"),this.theInfos=e}value(e){let s;const t=r=>{const i=this.theInfos[r],n=this.theInfos[r+1];i.value(new h((i=>{n||(s=i),s&&e.give(s),n&&!s&&t(r+1)})))};return t(0),this}}class O extends a{constructor(e,s){super([e]),this.baseSrc=e,this.applier=s}value(e){return this.baseSrc.value(new h(this.applier((s=>{e.give(s)})))),this}}class F extends a{constructor(e,s,t){super([e]),this.baseSrc=e,this.predicate=s,this.defaultValue=t}value(e){return this.baseSrc.value(new h((s=>{this.predicate(s)?e.give(s):void 0!==this.defaultValue&&e.give(this.defaultValue)}))),this}}var P=Object.defineProperty,V=(e,s,t)=>((e,s,t)=>s in e?P(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t)(e,s+"",t);class j extends a{constructor(e,...s){super([e]),this.waitForCb=e,V(this,"theArgs"),this.theArgs=s}value(e){return this.waitForCb((s=>{e.give(s)}),...this.theArgs),this}}class D extends a{constructor(e,s,t,r=new o("")){super([e,s,t,r]),this.emitterSrc=e,this.eventNameSrc=s,this.subscribeMethodSrc=t,this.unsubscribeMethodSrc=r}value(e){const t=new b(this.emitterSrc,this.eventNameSrc,this.subscribeMethodSrc,this.unsubscribeMethodSrc),r=s=>{e.give(s)};return t.value(new h((([e,t,i,n])=>{e[i](t,r),this.addDep(new s((()=>{e[n](t,r)})))}))),this}}class k extends a{constructor(e,s){super([e]),this.p=e,this.errorOwner=s}value(e){return this.p.then((s=>{e.give(s)})).catch((e=>{this.errorOwner?.give(e)})),this}}const E=e=>null!=e;var z=Object.defineProperty,A=(e,s,t)=>((e,s,t)=>s in e?z(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t)(e,"symbol"!=typeof s?s+"":s,t);class I{constructor(){A(this,"owners"),A(this,"innerOwner"),this.owners=new Set,this.innerOwner=new h((e=>{this.owners.forEach((s=>{s.give(e)}))}))}owner(){return this.innerOwner}size(){return this.owners.size}has(e){return this.owners.has(e)}add(e){return this.owners.add(e),this}remove(e){return this.owners.delete(e),this}destroy(){return this.owners.forEach((e=>{this.remove(e)})),this}}var K=Object.defineProperty,L=(e,s,t)=>((e,s,t)=>s in e?K(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t)(e,"symbol"!=typeof s?s+"":s,t);class M extends a{constructor(e){super([e]),this.theValue=e,L(this,"theOwner"),L(this,"lateOwner",new h((e=>{this.theValue=e,this.notify()})))}value(e){if(this.theOwner)throw new Error("Late component gets new owner, when another was already connected!");return this.theOwner=e,this.notify(),this}owner(){return this.lateOwner}notify(){return E(this.theValue)&&this.theOwner&&this.theOwner.give(this.theValue),this}}class C extends t{constructor(e,s){super(),this.baseLazy=e,this.applier=s}get(...e){return this.applier(this.baseLazy.get(...e))}}class N extends u{constructor(e){super(((...s)=>new e(...s)))}}class q extends a{constructor(e,s){super([e,s]),this.baseSrc=e,this.targetSrc=s}value(e){return this.baseSrc.value(new h((s=>{const t=[];s.forEach((e=>{let s=e;s instanceof a||(s=new o(s));const r=this.targetSrc.get(s);t.push(r)}));new b(...t).value(e)}))),this}}class B extends a{constructor(e){super(),this.baseSrc=e}value(e){let s=!1;return this.baseSrc.value(new h((t=>{s||(s=!0,e.give(t))}))),this}}class G extends a{constructor(e){super([e]),this.baseSrc=e}value(e){const s=[];return this.baseSrc.value(new h((t=>{s.push(t),e.give(s)}))),this}}var H=Object.defineProperty,J=(e,s,t)=>((e,s,t)=>s in e?H(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t)(e,"symbol"!=typeof s?s+"":s,t);class Q extends a{constructor(e,s=!1){super([e]),this.baseSrc=e,this.stateless=s,J(this,"lastValue"),J(this,"ownersPool",new I),this.addDep(this.ownersPool),this.baseSrc.value(new h((e=>{this.ownersPool.owner().give(e),this.lastValue=e})))}value(e){const s=new d((e=>(this.stateless||!E(this.lastValue)||this.ownersPool.has(e)||e.give(this.lastValue),this.ownersPool.add(e),()=>{this.ownersPool.remove(e)})));return s.value(e),this.addDep(s),this}pool(){return this.ownersPool}}class R extends a{constructor(e){super([e]),this.baseSrc=e}value(e){return this.baseSrc.value(new h((s=>{s.forEach((s=>{e.give(s)}))}))),this}}export{b as All,y as Any,g as Applied,x as Chain,i as DestroyFunc,r as Destroyable,O as ExecutorApplied,F as Filtered,h as From,j as FromCallback,D as FromEvent,k as FromPromise,M as Late,u as Lazy,C as LazyApplied,N as LazyClass,q as Map,o as Of,d as OfFunc,B as Once,I as OwnerPool,G as Sequence,Q as Shared,R as Stream,a as TheInformation,n as TheOwner,E as isFilled};
//# sourceMappingURL=silentium.min.mjs.map
