function t(t){return new e(t)}class e{constructor(t){this.value=t}to(t){return t.use(this.value),this}}const s=t=>null!=t;function r(t){return null!==t&&"object"==typeof t&&"to"in t&&"function"==typeof t.to}function n(t){return null!==t&&"object"==typeof t&&"destroy"in t&&"function"==typeof t.destroy}function i(t){return null!==t&&"object"==typeof t&&"destroyed"in t&&"function"==typeof t.destroy}function o(t){return null!==t&&"object"==typeof t&&"use"in t&&"function"==typeof t.use}function a(e){return r(e)?e:t(e)}function u(t){return new h(t)}class h{constructor(t){this.base=t}destroy(){return n(this.base)&&this.base.destroy(),this}}var c=Object.defineProperty,l=(t,e,s)=>((t,e,s)=>e in t?c(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,e+"",s);function p(){return new b}class b{constructor(){l(this,"destructors",[])}add(t){return n(t)&&this.destructors.push(t),t}destroy(){return this.destructors.forEach((t=>t.destroy())),this.destructors.length=0,this}}function f(t,e){if("function"!=typeof t)throw new Error(`${e}: is not function`)}function d(t,e){if(!r(t))throw new Error(`${e}: is not message`)}function w(t,e){if(!o(t))throw new Error(`${e}: is not transport`)}function y(t){return new m(t)}class m{constructor(t){this.executor=t,f(t,"Transport: transport executor")}use(t){return this.executor(t),this}}function $(t){return new v(t)}class v{constructor(t){this.executor=t,f(t,"TransportMessage: transport executor")}use(t){return this.executor(t)}}function g(t,...e){return new P(t,e)}class P{constructor(t,e=[],s){this.executor=t,this.args=e,this._child=s,f(t,"TransportParent: executor")}use(t){if(void 0===this._child)throw new Error("no base transport");return this.executor.call(this._child,t,...this.args),this}child(t,...e){return new P(this.executor,[...this.args,...e],t)}}var T=Object.defineProperty,j=(t,e,s)=>((t,e,s)=>e in t?T(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);function O(t){return new E(a(t))}class E{constructor(t){this.$base=t,j(this,"destroyed",!1),j(this,"transport",g((function(t,e){e.destroyed||this.use(t)}),this)),d(t,"Local: $base")}to(t){return this.$base.to(this.transport.child(t)),this}destroy(){return this.destroyed=!0,this}}var x=Object.defineProperty,M=(t,e,s)=>((t,e,s)=>e in t?x(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,e+"",s);function V(t){return new C(t)}class C{constructor(t){this.executor=t,M(this,"mbDestructor"),f(t,"Message: executor")}to(t){return this.mbDestructor=this.executor(t),this}destroy(){return"function"==typeof this.mbDestructor&&this.mbDestructor?.(),this}}function z(t){return V((e=>{e.use(t())}))}function A(t){return new k(t)}class k{constructor(t){this.base=t}wait(t){return void 0!==this.base&&t.to(this.base),this}}function F(){return new S}class S{use(){return this}}var B=Object.defineProperty,D=(t,e,s)=>((t,e,s)=>e in t?B(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);function I(...t){return new N(...t)}class N{constructor(...t){D(this,"known"),D(this,"filled",new Set),D(this,"$messages"),D(this,"result",[]),D(this,"transport",g((function(t,e,s){var r,n;e.filled.add(s),e.result[parseInt(s)]=t,r=e.filled,n=e.known,r.size>0&&r.size===n.size&&this.use(e.result)}),this)),this.known=new Set(Object.keys(t)),this.$messages=t.map(a)}to(t){return Object.entries(this.$messages).forEach((([e,s])=>{d(s,"All: item"),s.to(this.transport.child(t,e))})),0===this.known.size&&t.use([]),this}}var _=Object.defineProperty,L=(t,e,s)=>((t,e,s)=>e in t?_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,e+"",s);function R(...t){return new W(...t.map(a))}class W{constructor(...t){L(this,"$messages"),this.$messages=t}to(t){return this.$messages.forEach((e=>{d(e,"Any: item"),e.to(t)})),this}}var q=Object.defineProperty,G=(t,e,s)=>((t,e,s)=>e in t?q(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,e+"",s);function H(t,e){return new J(a(t),e)}class J{constructor(t,e){this.$base=t,this.applier=e,G(this,"transport",g((function(t,e){this.use(e.applier(t))}),this)),d(t,"Applied: base")}to(t){return this.$base.to(this.transport.child(t)),this}}function K(t,e){return H(t,(t=>e(...t)))}function Q(t,e,s){return new U(t,e,s)}class U{constructor(t,e,s){this.$base=t,this.errorMessage=e,this.errorOriginal=s,d(t,"Catch: base"),w(e,"Catch: errorMessage"),void 0!==s&&w(s,"Catch: errorOriginal")}to(t){try{this.$base.to(t)}catch(t){t instanceof Error?this.errorMessage.use(t.message):this.errorMessage.use(String(t)),this.errorOriginal&&this.errorOriginal.use(t)}return this}}var X=Object.defineProperty,Y=(t,e,s)=>((t,e,s)=>e in t?X(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);function Z(...t){return new tt(...t)}class tt{constructor(...t){Y(this,"$messages"),Y(this,"$latest"),Y(this,"handleMessage",((t,e)=>{const s=this.$messages[t],r=this.$messages[t+1];s.to(this.oneMessageTransport.child(e,r,t))})),Y(this,"oneMessageTransport",g((function(t,e,s,r){s||(e.$latest=t),e.$latest&&this.use(e.$latest),s&&!e.$latest&&e.handleMessage(r+1,this)}),this)),this.$messages=t}to(t){return this.handleMessage(0,t),this}}function et(t,e){return new st(t,e)}class st{constructor(t,e){this.$base=t,this.applier=e,d(t,"ExecutorApplied: base")}to(t){const e=this.applier(t.use.bind(t));return this.$base.to(y(e)),this}}var rt=Object.defineProperty,nt=(t,e,s)=>((t,e,s)=>e in t?rt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,e+"",s);function it(t,e,s){return new ot(a(t),e,s)}class ot{constructor(t,e,s){this.$base=t,this.predicate=e,this.defaultValue=s,nt(this,"parent",g((function(t,e){e.predicate(t)?this.use(t):void 0!==e.defaultValue&&this.use(e.defaultValue)}),this))}to(t){return this.$base.to(this.parent.child(t)),this}}var at=Object.defineProperty,ut=(t,e,s)=>((t,e,s)=>e in t?at(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);function ht(t,e,s,r){return new ct(a(t),a(e),a(s),a(r))}class ct{constructor(t,e,s,r){this.$emitter=t,this.$eventName=e,this.$subscribeMethod=s,this.$unsubscribeMethod=r,ut(this,"lastTransport",null),ut(this,"handler",(t=>{this.lastTransport&&this.lastTransport.use(t)})),ut(this,"parent",g((function([t,e,s],r){r.lastTransport=this,t?.[s]&&t[s](e,r.handler)}),this))}to(t){return I(this.$emitter,this.$eventName,this.$subscribeMethod).to(this.parent.child(t)),this}destroy(){return this.lastTransport=null,this.$unsubscribeMethod?(I(this.$emitter,this.$eventName,this.$unsubscribeMethod).to(y((([t,e,s])=>{t?.[s]?.(e,this.handler)}))),this):this}}function lt(t,e){return new pt(t,e)}class pt{constructor(t,e){this.p=t,this.error=e}to(t){return this.p.then((e=>{t.use(e)})).catch((t=>{this.error?.use(t)})),this}}var bt=Object.defineProperty,ft=(t,e,s)=>((t,e,s)=>e in t?bt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);function dt(t){return new wt(t)}class wt{constructor(t){this.v=t,ft(this,"lateTransport",null),ft(this,"notify",(t=>{s(t)&&this.lateTransport&&this.lateTransport.use(t)}))}to(t){if(this.lateTransport)throw new Error("Late component gets new transport, when another was already connected!");return this.lateTransport=t,this.notify(this.v),this}use(t){return this.notify(t),this}}var yt=Object.defineProperty,mt=(t,e,s)=>((t,e,s)=>e in t?yt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);function $t(t){return new vt(t)}class vt{constructor(t){this.$base=t,mt(this,"isFilled",!1),mt(this,"parent",g((function(t,e){e.isFilled||(e.isFilled=!0,this.use(t))}),this))}to(t){return this.$base.to(this.parent.child(t)),this}}var gt=Object.defineProperty,Pt=(t,e,s)=>((t,e,s)=>e in t?gt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);class Tt{constructor(){Pt(this,"transports"),Pt(this,"innerTransport"),this.transports=new Set,this.innerTransport=y((t=>{this.transports.forEach((e=>{i(e)&&e.destroyed()?this.transports.delete(e):e.use(t)}))}))}transport(){return this.innerTransport}size(){return this.transports.size}has(t){return this.transports.has(t)}add(t){return this.transports.add(t),this}remove(t){return this.transports.delete(t),this}destroy(){return this.transports.forEach((t=>{this.remove(t)})),this}}var jt=Object.defineProperty,Ot=(t,e,s)=>((t,e,s)=>e in t?jt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);function Et(t,e=!1){return new xt(t,e)}class xt{constructor(t,e=!1){this.$base=t,this.stateless=e,Ot(this,"transportPool",new Tt),Ot(this,"lastValue"),Ot(this,"calls",dt()),Ot(this,"firstCallTransport",y((t=>{this.lastValue=t,this.transportPool.transport().use(t)}))),$t(this.calls).to(y((()=>{this.$base.to(this.firstCallTransport)})))}to(t){return this.calls.use(1),this.stateless||!s(this.lastValue)||this.transportPool.has(t)||t.use(this.lastValue),this.transportPool.add(t),this}use(t){return this.calls.use(1),this.lastValue=t,this.transportPool.transport().use(t),this}touched(){this.calls.use(1)}pool(){return this.transportPool}destroy(){return this.transportPool.destroy()}}var Mt=Object.defineProperty,Vt=(t,e,s)=>((t,e,s)=>e in t?Mt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,e+"",s);function Ct(t,e=!1){return new zt(t,e)}class zt{constructor(t,e=!1){this.$base=t,Vt(this,"$sharedBase"),this.$sharedBase=Et(this.$base,e)}to(t){return this.$sharedBase.to(t),this}use(t){return this.$sharedBase.touched(),this.$base.use(t),this}}var At=Object.defineProperty,kt=(t,e,s)=>((t,e,s)=>e in t?At(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,e+"",s);function Ft(t,e=null){return new St(t,e)}class St{constructor(t,e=null){this.$base=t,this.theValue=e,kt(this,"touched",!1)}ensureTouched(){this.touched||this.$base.to(y((t=>{this.theValue=t}))),this.touched=!0}[Symbol.toPrimitive](){return this.ensureTouched(),this.theValue}primitive(){return this.ensureTouched(),this.theValue}primitiveWithException(){if(this.ensureTouched(),null===this.theValue)throw new Error("Primitive value is null");return this.theValue}}var Bt=Object.defineProperty,Dt=(t,e,s)=>((t,e,s)=>e in t?Bt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);function It(t){return new Nt(t)}class Nt{constructor(t){Dt(this,"$msg"),Dt(this,"primitive"),this.$msg=Ct(dt(t)),this.primitive=Ft(this,t)}to(t){return this.$msg.to(t),this}use(t){return this.$msg.use(t),this}value(){return this.primitive}}var _t=Object.defineProperty,Lt=(t,e,s)=>((t,e,s)=>e in t?_t(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,e+"",s);function Rt(t,e){return new Wt(a(t),e)}class Wt{constructor(e,s){this.$base=e,this.$target=s,Lt(this,"parent",g((function(e,s){const n=[];e.forEach((e=>{let i=e;r(i)||(i=t(i));const o=s.$target.use(i);n.push(o)})),I(...n).to(this)}),this))}to(t){return this.$base.to(this.parent.child(t)),this}}var qt=Object.defineProperty,Gt=(t,e,s)=>((t,e,s)=>e in t?qt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);function Ht(t){return new Jt(a(t))}Ht.transport={};class Jt{constructor(t){this.$rpc=t,Gt(this,"$result",It()),Gt(this,"$error",It())}result(){return this.$rpc.to(y((t=>{const e=void 0===t.transport?Ht.transport.default:Ht.transport[t.transport]||Ht.transport.default;if(!e)throw new Error(`RPCImpl: Transport not found ${t.transport}`);t.result||(t.result=this.$result),t.error||(t.error=this.$error),e.use(t)}))),this.$result}error(){return this.$error}}function Kt(t){return y((e=>{if(!e.result)throw new Error("RPCChain did not find result in rpc message");a(t).to(e.result)}))}function Qt(t){const e=It();return Ht.transport[t]=e,V((t=>{e.to(t)}))}var Ut=Object.defineProperty,Xt=(t,e,s)=>((t,e,s)=>e in t?Ut(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);function Yt(t){return new Zt(t)}class Zt{constructor(t){this.$base=t,Xt(this,"result",[]),Xt(this,"parent",g((function(t,e){e.result.push(t),this.use(e.result)}),this))}to(t){return this.$base.to(this.parent.child(t)),this}}var te=Object.defineProperty,ee=(t,e,s)=>((t,e,s)=>e in t?te(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,e+"",s);function se(t){return new re(t)}class re{constructor(t){this.$base=t,ee(this,"parent",g((function(t){t.forEach((t=>{this.use(t)}))})))}to(t){return this.$base.to(this.parent.child(t)),this}}function ne(t,e){return new ie(t,e)}class ie{constructor(t,e){this.baseTransport=t,this.applier=e}use(t){return this.applier(this.baseTransport.use(t))}}function oe(t,e,s=0){return new ae(t,e,s)}class ae{constructor(t,e,s=0){this.baseTransport=t,this.args=e,this.startFromArgIndex=s}use(t){return this.baseTransport.use(function(t,e,s){const r=t.slice(0,s);for(;r.length<s;)r.push(void 0);return r.concat(e)}(t,this.args,this.startFromArgIndex))}}var ue=Object.defineProperty,he=(t,e,s)=>((t,e,s)=>e in t?ue(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,e+"",s);function ce(t){return new le(t)}class le{constructor(t){this.baseTransport=t,he(this,"destructors",[])}use(t){const e=this.baseTransport.use(t);return n(e)&&this.destructors.push(e),e}destroy(){return this.destructors.forEach((t=>t.destroy())),this}}export{a as ActualMessage,I as All,N as AllImpl,R as Any,W as AnyImpl,H as Applied,K as AppliedDestructured,J as AppliedImpl,Q as Catch,U as CatchImpl,Z as Chain,tt as ChainImpl,p as DestroyContainer,b as DestroyContainerImpl,u as Destroyable,h as DestroyableImpl,et as ExecutorApplied,st as ExecutorAppliedImpl,it as Filtered,ot as FilteredImpl,ht as FromEvent,ct as FromEventImpl,lt as FromPromise,pt as FromPromiseImpl,dt as Late,wt as LateImpl,It as LateShared,Nt as LateSharedImpl,O as Local,E as LocalImpl,Rt as Map,Wt as MapImpl,V as Message,C as MessageImpl,z as New,t as Of,e as OfImpl,$t as Once,vt as OnceImpl,Ft as Primitive,St as PrimitiveImpl,Ht as RPC,Kt as RPCChain,Jt as RPCImpl,Qt as RPCOf,Yt as Sequence,Zt as SequenceImpl,Et as Shared,xt as SharedImpl,Ct as SharedSource,zt as SharedSourceImpl,se as Stream,re as StreamImpl,y as Transport,ne as TransportApplied,ie as TransportAppliedImpl,oe as TransportArgs,ae as TransportArgsImpl,ce as TransportDestroyable,le as TransportDestroyableImpl,m as TransportImpl,$ as TransportMessage,v as TransportMessageImpl,A as TransportOptional,k as TransportOptionalImpl,g as TransportParent,P as TransportParentImpl,Tt as TransportPool,F as Void,S as VoidImpl,f as ensureFunction,d as ensureMessage,w as ensureTransport,n as isDestroyable,i as isDestroyed,s as isFilled,r as isMessage,o as isTransport};
//# sourceMappingURL=silentium.min.mjs.map
