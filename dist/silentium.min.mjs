const t=t=>null!=t;function e(t){return null!==t&&"object"==typeof t&&"then"in t&&"function"==typeof t.then}function n(t){return null!==t&&"object"==typeof t&&"destroy"in t&&"function"==typeof t.destroy}function r(t){return null!==t&&"object"==typeof t&&"destroyed"in t&&"function"==typeof t.destroyed}function s(t){return new i(t)}class i{constructor(t){this.base=t}destroy(){return n(this.base)&&this.base.destroy(),"function"==typeof this.base&&this.base(),this}}var o=Object.defineProperty,c=(t,e,n)=>((t,e,n)=>e in t?o(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,e+"",n);function u(){return new h}class h{constructor(){c(this,"destructors",[])}add(t){return this.destructors.push(s(t)),t}destroy(){return this.destructors.forEach((t=>t.destroy())),this.destructors.length=0,this}}var a=Object.defineProperty,l=(t,e,n)=>((t,e,n)=>e in t?a(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,"symbol"!=typeof e?e+"":e,n);class f{constructor(){l(this,"catchers",[]),l(this,"lastRejectReason",null),l(this,"reject",(t=>{this.lastRejectReason=t,this.catchers.forEach((e=>{e(t)}))}))}catch(t){return null!==this.lastRejectReason&&t(this.lastRejectReason),this.catchers.push(t),this}destroy(){return this.catchers.length=0,this}}function d(t,e){if("function"!=typeof t)throw new Error(`${e}: is not function`)}function b(t,n){if(!e(t))throw new Error(`${n}: is not message`)}var y=Object.defineProperty,p=(t,e,n)=>((t,e,n)=>e in t?y(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,"symbol"!=typeof e?e+"":e,n);function w(t){return new v(t)}class v{constructor(t){this.executor=t,p(this,"rejections",new f),p(this,"dc",u()),d(t,"Message: executor")}then(t){let n=this;try{const r=r=>{const s=t(r);this.dc.add(s),e(s)&&(n=s)};this.dc.add(this.executor(r,this.rejections.reject))}catch(t){this.rejections.reject(t)}return n}catch(t){return this.rejections.catch(t),this}destroy(){return this.dc.destroy(),this.rejections.destroy(),this}}function j(t){return w((function(e){e(t)}))}function m(t){return e(t)?t:j(t)}class g{constructor(t){this.src=t}chain(t){return t.then(this.src.use.bind(this.src)),this}}function E(t){const e=m(t);return w((function(t){let n=!1;return e.then((e=>{n||t(e)})),()=>{n=!0}}))}var R=Object.defineProperty,V=(t,e,n)=>((t,e,n)=>e in t?R(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,e+"",n);function x(t,e){return new P(t,e)}class P{constructor(t,e){this.sourceExecutor=e,V(this,"message"),this.message=w(t)}use(t){return this.sourceExecutor(t),this}then(t){return this.message.then(t),this}catch(t){return this.message.catch(t),this}}function O(t){return w((function(e){e(t())}))}function $(){return()=>{}}function z(...t){const e=t.map(m);return w((function(n){const r=new Set(Object.keys(t)),s=new Set,i=[];0!==r.size?e.map(((t,e)=>{t.then((t=>{var o,c;s.add(e.toString()),i[e]=t,c=r,(o=s).size>0&&o.size===c.size&&n(i)}))})):n([])}))}function S(...t){const e=t.map(m);return w((function(t){e.forEach((e=>{e.then(t)}))}))}function T(t,e){const n=m(t);return w((function(t){n.then((n=>{t(e(n))}))}))}function C(t,e){return T(t,(function(t){return e(...t)}))}var M=Object.defineProperty,k=(t,e,n)=>((t,e,n)=>e in t?M(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,"symbol"!=typeof e?e+"":e,n);function L(t){return new W(t)}class W{constructor(e){this.v=e,k(this,"rejections",new f),k(this,"lateR",null),k(this,"notify",(()=>{if(t(this.v)&&this.lateR)try{this.lateR(this.v)}catch(t){this.rejections.reject(t)}}))}then(t){if(this.lateR)throw new Error("Late component gets new resolver, when another was already connected!");return this.lateR=t,this.notify(),this}use(t){return this.v=t,this.notify(),this}catch(t){return this.rejections.catch(t),this}}function q(t){const e=new f;t.catch(e.reject);const n=L();return e.catch((t=>{n.use(t)})),n}function A(...t){const e=t.map(m);return w((function(t){let n;const r=s=>{const i=e[s],o=e[s+1];i.then((e=>{!function(e,s,i){s||(n=e);n&&t(n);s&&!n&&r(i+1)}(e,o,s)}))};r(0)}))}function B(t){const e=m(t);return w(((t,n)=>{e.then((e=>{const r=B.transport.get(e.transport);if(void 0===r)throw new Error(`Context: unknown transport ${e.transport}`);e.result||(e.result=t),e.error||(e.error=n);try{r(e)}catch(t){n(t)}}))}))}function D(t){return e=>{if(!e.result)throw new Error("ContextChain did not find result in rpc message");m(t).then(e.result)}}B.transport=new Map;var F=Object.defineProperty,G=(t,e,n)=>((t,e,n)=>e in t?F(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,e+"",n);function H(t,e=null){return new I(t,e)}class I{constructor(t,e=null){this.$base=t,this.theValue=e,G(this,"touched",!1)}ensureTouched(){this.touched||this.$base.then((t=>{this.theValue=t})),this.touched=!0}[Symbol.toPrimitive](){return this.ensureTouched(),this.theValue}primitive(){return this.ensureTouched(),this.theValue}primitiveWithException(){if(this.ensureTouched(),null===this.theValue)throw new Error("Primitive value is null");return this.theValue}}var J=Object.defineProperty,K=(t,e,n)=>((t,e,n)=>e in t?J(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,"symbol"!=typeof e?e+"":e,n);function N(t,e){return new Q(t,e)}class Q{constructor(t,e){this.$base=t,this.source=e,K(this,"resolver",(t=>{this.lastV=t,this.resolvers.forEach((e=>{e(t)}))})),K(this,"lastV"),K(this,"resolvers",new Set)}then(e){return this.resolvers.add(e),1===this.resolvers.size?this.$base.then(this.resolver):t(this.lastV)&&e(this.lastV),this}use(t){return this.source?this.source.use(t):this.resolver(t),this}catch(t){return this.$base.catch(t),this}destroy(){return this.resolvers.clear(),this}value(){return H(this)}chain(t){return t.then(this.use.bind(this)),this}}function U(t){const e=L(t);return N(e,e)}function X(t){const e=U();return B.transport.set(t,e.use.bind(e)),w((t=>{e.then(t)}))}function Y(t,e){return w((function(n){t.then(e(n))}))}function Z(t,e,n){const r=m(t);return w((function(t){r.then((r=>{e(r)?t(r):void 0!==n&&t(n)}))}))}function _(t,e,n,r){const s=m(t),i=m(e),o=m(n),c=m(r);return w((t=>{let e=null;const n=t=>{e&&e(t)};return z(s,i,o).then((([r,s,i])=>{e=t,r?.[i]&&r[i](s,n)})),()=>{e=null,c&&z(s,i,c).then((([t,e,r])=>{t?.[r]?.(e,n)}))}}))}function tt(t,n){const r=m(t);return w((t=>{const s=[],i=u();r.then((r=>{i.destroy(),r.forEach((t=>{let r=t;e(r)||(r=j(r));const o=n(r);i.add(o),s.push(o)})),z(...s).then(t)}))}))}function et(t){return w((e=>{let n=!1;t.then((t=>{n||(n=!0,e(t))}))}))}function nt(t){return w((e=>{const n=[];t.then((t=>{n.push(t),e(n)}))}))}function rt(t){const e=m(t);return w((t=>{e.then((e=>{e.forEach((e=>{t(e)}))}))}))}export{m as ActualMessage,z as All,S as Any,T as Applied,C as AppliedDestructured,q as Catch,A as Chain,g as Chainable,B as Context,D as ContextChain,X as ContextOf,u as DestroyContainer,h as DestroyContainerImpl,s as Destroyable,i as DestroyableImpl,Y as ExecutorApplied,Z as Filtered,_ as FromEvent,L as Late,W as LateImpl,U as LateShared,E as Local,tt as Map,w as Message,v as MessageRx,x as MessageSource,P as MessageSourceImpl,O as New,j as Of,et as Once,H as Primitive,I as PrimitiveImpl,f as Rejections,nt as Sequence,N as Shared,Q as SharedImpl,rt as Stream,$ as Void,d as ensureFunction,b as ensureMessage,n as isDestroyable,r as isDestroyed,t as isFilled,e as isMessage};
//# sourceMappingURL=silentium.min.mjs.map
