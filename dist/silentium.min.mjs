const e=(e,t)=>{if(null==e)throw new Error("value didn't receive source argument");if(void 0===t||null===e)throw new Error("value didn't receive guest argument");return"function"==typeof e?e(t):"object"==typeof e&&"value"in e&&"function"==typeof e.value?e.value(t):o(e,t),e},t=(t,r)=>{if(null==t)throw new Error("value didn't receive source argument");if(void 0===r||null===t)throw new Error("value didn't receive guest argument");return Array.isArray(r)?r.forEach((r=>{e(t,r)})):e(t,r),t},r=e=>null!==e&&"object"==typeof e&&"value"in e&&"function"==typeof e.value||null!=e,n=e=>{if(void 0===e)throw new Error("Source constructor didn't receive executor function");return r=>{t(e,r)}},o=(e,t)=>{if(void 0===e)throw new Error("give didn't receive data argument");return void 0===t?n(e):("function"==typeof t?t(e):t.give(e),t)},i=e=>{if(void 0===e)throw new Error("isGuest didnt receive mbGuest argument");return"function"==typeof e||"function"==typeof e?.give},u=e=>{if(!e)throw new Error("receiver function was not passed to Guest constructor");const t={give:r=>(e(r),t)};return t},s=e=>{let t=!1;return()=>{t||e(),t=!0}},c=(e,t)=>{if(void 0===e)throw new Error("GuestCast didn't receive sourceGuest argument");if(void 0===t)throw new Error("GuestCast didn't receive targetGuest argument");const r={disposed(t){const r=e;return!!r.disposed&&r.disposed(t)},give:e=>(o(e,t),r),introduction:()=>"function"==typeof e?"guest":e.introduction?e.introduction():"guest"};return r},a=e=>{const t={give:r=>(e=r,t),value(){if(void 0===e)throw new Error("no value in GuestSync!");return e}};return t},d=(e,t)=>{if(void 0===e)throw new Error("GuestDisposable didn't receive guest argument");if(void 0===t)throw new Error("GuestDisposable didn't receive disposeCheck argument");const r={disposed:e=>t(e),give:t=>(o(t,e),r)};return r},v=(e,t)=>{const r={give:n=>(o(t(n),e),r)};return r},l=(e,t)=>({give:t((t=>o(t,e)))}),h=e=>"object"==typeof e&&null!==e&&"patron"===e?.introduction?.(),f=()=>"patron",g=e=>{if(void 0===e)throw new Error("Patron didn't receive willBePatron argument");const t={give:r=>(o(r,e),t),disposed(t){const r=e;return r?.disposed?.(t)||!1},introduction:f};return t},w=e=>{if(void 0===e)throw new Error("PatronOnce didn't receive baseGuest argument");let t=!1;const r={give:n=>(t||(t=!0,o(n,e)),r),disposed(r){if(t)return!0;const n=e;return!!n.disposed&&n.disposed(r)},introduction:f};return r};var p=Object.defineProperty,E=(e,t,r)=>((e,t,r)=>t in e?p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);const y=new Map,m=new Map,b=new Map,S=[],G=()=>{S.forEach((e=>e()))},P={poolsCount:0,patronsCount:0},j=n((e=>{o(P,e),S.push((()=>{let t=0;y.forEach((e=>{t+=e.size})),P.poolsCount=y.size,P.patronsCount=t,o(P,e)}))})),z=(e,t)=>(b.has(t)||b.set(t,[]),b.get(t)?.push(e),e),C=(e,t)=>(t.forEach((t=>{z(e,t)})),e),D=e=>"object"==typeof e&&null!==e&&"destroy"in e&&"function"==typeof e.destroy,M=(...e)=>{e.forEach((e=>{D(e)&&e.destroy();const t=m.get(e);t?.destroy();const r=b.get(e);b.delete(e),r&&M(...r)}))},O=e=>{const t=[];return y.forEach(((r,n)=>{r.has(e)&&t.push(n)})),t},V=e=>{if(void 0===e)throw new Error("removePatronFromPools didn't receive patron argument");y.forEach((t=>{t.delete(e)})),G()},A=e=>{if(void 0===e)throw new Error("isPatronInPools didn't receive patron argument");let t=!1;return y.forEach((r=>{t||(t=r.has(e))})),t};class k{constructor(e){this.initiator=e,E(this,"patrons"),E(this,"give"),this.patrons=new Set,y.set(this,this.patrons),m.set(this.initiator,this);const t=e=>{this.patrons.forEach((t=>{this.sendValueToGuest(e,t)}))};this.give=e=>(t(e),this),G()}size(){return this.patrons.size}add(e){if(!e)throw new Error("PatronPool add method received nothing!");return"function"!=typeof e&&e.introduction&&"patron"===e.introduction()&&this.patrons.add(e),G(),this}remove(e){return this.patrons.delete(e),G(),this}distribute(e,t){return this.add(t),this.sendValueToGuest(e,t),this}destroy(){return this.patrons.forEach((e=>{this.remove(e)})),y.delete(this),m.delete(this.initiator),G(),this}sendValueToGuest(e,t){return this.guestDisposed(e,t)||o(e,t),this}guestDisposed(e,t){return!!t.disposed?.(e)&&(this.remove(t),!0)}}const F=(e,t)=>{const r=v(e,t),n={give:e=>(r.give(e),n),introduction:f};return n},T=(e,t)=>{const r=l(e,t),n={give:e=>(r.give(e),n),introduction:f};return n},q=(e,r)=>{const n=a(r);t(e,g(n));const o={value(r){return t(e,r),this},syncValue(){try{return n.value()}catch{throw new Error("No value in SourceSync")}}};return z(o,e),o},x=e=>null==e,B=e=>{const n={},o=new k(n);let i=x(e);return!i&&r(e)&&t(e,w((t=>{i=x(t),e=t}))),n.value=t=>i?(h(t)&&o.add(t),n):("function"==typeof t?o.distribute(e,u(t)):o.distribute(e,t),n),n.give=t=>(i=x(t),e=t,i||o.give(e),n),n},I=e=>{const t=B(e),r=q(t,null),n={value:t.value,give:e=>(r.syncValue()!==e&&o(e,t.give),n)};return n},N=e=>{const r=new Set(Object.keys(e)),n=new Set,i=B({}),a=[],d=s((()=>{Object.entries(e).forEach((([e,o])=>{z(i,o),r.add(e);const s=g((t=>{i.value(u((r=>{n.add(e);const o={...r,[e]:t};i.give(o)})))}));a.push(s),t(o,s)}))}));return{value(e){d();const t=c(e,(t=>{n.size>0&&n.size===r.size&&o(Object.values(t),e)}));a.push(t),i.value(t)},destroy(){a.forEach((e=>{V(e)}))}}},R=(e,n)=>{if(void 0===e)throw new Error("SourceSequence didn't receive baseSource argument");if(void 0===n)throw new Error("SourceSequence didn't receive targetSource argument");return i=>{const u=B(),s=n.get(u);t(e,c(i,(e=>{let n=0;const c=[];e.forEach((()=>{c.push(B())}));const a=()=>{void 0!==e[n+1]&&(n+=1,d())};function d(){const o=c[n],i=e[n];r(i)?t(i,w((e=>{u.give(e),t(s,o),a()}))):(u.give(i),t(s,o),a())}void 0!==e[n]?(d(),t(N(c),i)):o([],i)})))}},W=(e,r)=>{if(void 0===e)throw new Error("SourceMap didn't receive baseSource argument");if(void 0===r)throw new Error("SourceMap didn't receive targetSource argument");const n=B(),i=s((()=>{t(e,g((i=>{const u=[];i.forEach((t=>{const n=r.get(t);z(n,e),u.push(n)})),t(N(u),w((e=>{M(...u),o(e,n)})))})))}));return e=>{i(),n.value(e)}},H=e=>{if(void 0===e)throw new Error("SourceRace didnt receive sources argument");return r=>{let n=null;e.forEach((e=>{t(e,c(r,(t=>{n&&n!==e||(o(t,r),n=e)})))}))}},J=(...e)=>{const r=B(),n=new WeakMap,o=i=>{const u=e[i],s=e[i+1];t(u,g((e=>{let c=u;"object"==typeof u&&null!==u||"function"==typeof u||Array.isArray(u)||(c={source:u}),s&&t(r,r),s?n.has(c)||o(i+1):r.give(e),n.set(c,1)})))},i=s((()=>{o(0)}));return e=>{i(),r.value(e)}},K=(e,r)=>{if(void 0===e)throw new Error("SourceDynamic didn't receive baseGuest argument");if(void 0===r)throw new Error("SourceDynamic didn't receive baseSource argument");const n={value:e=>(t(r,e),n),give(t){return o(t,e),this}};return n},L=(e,r)=>n=>{t(e,c(n,(e=>{o(r(e),n)})))},Q=(e,r)=>n=>{t(e,c(n,r((e=>{o(e,n)}))))},U=(e,r,n)=>i=>{t(e,c(i,(e=>{!0===r(e)?o(e,i):void 0!==n&&o(n,i)})))},X=e=>{let r=void 0!==e;const n=B(e);return{value(e){return t(n,e),this},give(e){return r||(n.give(e),r=!0),this}}},Y=(...e)=>r=>{const n=B();return C(n,e),t(N(e),g((e=>{r(n.give,...e)}))),n.value},Z=(e,r)=>{const n=B(),i=s((()=>{t(r,g((()=>{o(null,n)}))),t(e,g(n)),z(n,e)}));return K(n.give,(e=>{i(),n.value(e)}))},$=e=>{const r=B(),n=s((()=>{e.forEach((e=>{t(e,g(r))}))}));return e=>{n(),r.value(e)}},_=(e,r,n)=>{let o=null;const i=B(),u=Z(i,n??B());let s=!1;return n&&t(n,g((()=>{M(o),o=null}))),n=>{s||(s=!0,t(N(r),g((()=>{o||(o=e.get(...r),t(o,g(i)))})))),t(u,n)}},ee=e=>{let t=null;return{value(r){return t=e(r),this},destroy(){return null!==t&&"function"==typeof t&&t(),this}}},te=(e,t={})=>{if(void 0===e)throw new Error("PrivateClass didn't receive constructorFn argument");return{get:(...r)=>new e(...r,t)}},re=e=>{if(void 0===e)throw new Error("lazy didn't receive buildingFn argument");return{get:(...t)=>e(...t)}};export{k as PatronPool,M as destroy,s as firstVisit,o as give,u as guest,v as guestApplied,c as guestCast,d as guestDisposable,l as guestExecutorApplied,a as guestSync,f as introduction,D as isDestroyable,i as isGuest,h as isPatron,A as isPatronInPools,r as isSource,re as lazy,te as lazyClass,g as patron,F as patronApplied,T as patronExecutorApplied,w as patronOnce,O as patronPools,j as patronPoolsStatistic,V as removePatronFromPools,n as source,N as sourceAll,$ as sourceAny,L as sourceApplied,J as sourceChain,Y as sourceCombined,ee as sourceDestroyable,K as sourceDynamic,Q as sourceExecutorApplied,U as sourceFiltered,_ as sourceLazy,W as sourceMap,I as sourceMemoOf,B as sourceOf,X as sourceOnce,H as sourceRace,Z as sourceResettable,R as sourceSequence,q as sourceSync,z as subSource,C as subSourceMany,t as value};
//# sourceMappingURL=silentium.min.mjs.map
