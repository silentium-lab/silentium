const t=t=>null!=t;function e(t){return null!==t&&"object"==typeof t&&"then"in t&&"function"==typeof t.then}function n(t){return null!==t&&"object"==typeof t&&"use"in t&&"function"==typeof t.use}function r(t){return null!==t&&"object"==typeof t&&"destroy"in t&&"function"==typeof t.destroy}function s(t){return null!==t&&"object"==typeof t&&"destroyed"in t&&"function"==typeof t.destroyed}function c(t){return new i(t)}class i{constructor(t){this.base=t}destroy(){return r(this.base)&&this.base.destroy(),"function"==typeof this.base&&this.base(),this}}var o=Object.defineProperty,u=(t,e,n)=>((t,e,n)=>e in t?o(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,e+"",n);function h(){return new a}class a{constructor(){u(this,"destructors",[])}add(t){return this.destructors.push(c(t)),t}destroy(){return this.destructors.forEach(t=>t.destroy()),this.destructors.length=0,this}}var l=Object.defineProperty,f=(t,e,n)=>((t,e,n)=>e in t?l(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,"symbol"!=typeof e?e+"":e,n);class d{constructor(){f(this,"catchers",[]),f(this,"lastRejectReason",null),f(this,"reject",t=>{this.lastRejectReason=t,this.catchers.forEach(e=>{e(t)})})}catch(t){return null!==this.lastRejectReason&&t(this.lastRejectReason),this.catchers.push(t),this}destroy(){return this.catchers.length=0,this}}function b(e){let n;return r=>{t(r)&&r!==n&&(n=r,e(r))}}function y(t,e){if("function"!=typeof t)throw new Error(`${e}: is not function`)}function p(t,n){if(!e(t))throw new Error(`${n}: is not message`)}var w=Object.defineProperty,v=(t,e,n)=>((t,e,n)=>e in t?w(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,"symbol"!=typeof e?e+"":e,n);function m(t){return new j(t)}class j{constructor(t){this.executor=t,v(this,"rejections",new d),v(this,"dc",h()),y(t,"Message: executor")}then(t){try{this.dc.add(this.executor(b(t),this.rejections.reject))}catch(t){this.rejections.reject(t)}return this}catch(t){return this.rejections.catch(t),this}destroy(){return this.dc.destroy(),this.rejections.destroy(),this}}function g(t){return m(function(e){e(t)})}function E(t){return e(t)?t:g(t)}function $(t){return new R(t)}class R{constructor(t){this.src=t}chain(t){return t.then(this.src.use.bind(this.src)),this}}function P(t){const e=E(t);return m(function(t,n){let r=!1;return e.then(e=>{r||t(e)}),e.catch(n),()=>{r=!0}})}var V=Object.defineProperty,x=(t,e,n)=>((t,e,n)=>e in t?V(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,e+"",n);function O(t,e){return new S(t,e)}class S{constructor(t,e){this.sourceExecutor=e,x(this,"message"),this.message=m(t)}use(t){return this.sourceExecutor(t),this}then(t){return this.message.then(t),this}catch(t){return this.message.catch(t),this}}function z(t){return m(function(e){e(t())})}function T(){return()=>{}}function C(...t){const e=t.map(E);return m(function(n,r){const s=new Set(Object.keys(t)),c=new Set,i=[];0!==s.size?e.map((t,e)=>{t.catch(r),t.then(t=>{var r,o;c.add(e.toString()),i[e]=t,o=s,(r=c).size>0&&r.size===o.size&&n(i)})}):n([])})}function M(...t){const e=t.map(E);return m(function(t,n){e.forEach(e=>{e.catch(n),e.then(t)})})}function k(t,e){const n=E(t);return m(function(t,r){n.catch(r),n.then(n=>{t(e(n))})})}function L(t,e){return k(t,function(t){return e(...t)})}var W=Object.defineProperty,q=(t,e,n)=>((t,e,n)=>e in t?W(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,"symbol"!=typeof e?e+"":e,n);function A(t){return new B(t)}class B{constructor(e){this.v=e,q(this,"rejections",new d),q(this,"lateR",null),q(this,"notify",()=>{if(t(this.v)&&this.lateR)try{this.lateR(this.v)}catch(t){this.rejections.reject(t)}})}then(t){if(this.lateR)throw new Error("Late component gets new resolver, when another was already connected!");return this.lateR=b(t),this.notify(),this}use(t){return this.v=t,this.notify(),this}catch(t){return this.rejections.catch(t),this}}function D(t){const e=new d;t.catch(e.reject);const n=A();return e.catch(t=>{n.use(t)}),n}function F(...t){const e=t.map(E);return m(function(t,n){let r;const s=c=>{const i=e[c];i.catch(n);const o=e[c+1];i.then(e=>{!function(e,n,c){n||(r=e);r&&t(r);n&&!r&&s(c+1)}(e,o,c)})};s(0)})}function G(t,...e){return L(C(...e),t)}function H(t){const e=E(t);return m((t,n)=>{e.then(e=>{const r=H.transport.get(e.transport);if(void 0===r)throw new Error(`Context: unknown transport ${e.transport}`);e.result||(e.result=t),e.error||(e.error=n);try{r(e)}catch(t){n(t)}})})}function I(t){const e=E(t);return t=>{if(!t.result)throw new Error("ContextChain did not find result in rpc message");e.then(t.result)}}H.transport=new Map;var J=Object.defineProperty,K=(t,e,n)=>((t,e,n)=>e in t?J(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,e+"",n);function N(t,e=null){return new Q(t,e)}class Q{constructor(t,e=null){this.$base=t,this.theValue=e,K(this,"touched",!1)}ensureTouched(){this.touched||this.$base.then(t=>{this.theValue=t}),this.touched=!0}[Symbol.toPrimitive](){return this.ensureTouched(),this.theValue}primitive(){return this.ensureTouched(),this.theValue}primitiveWithException(){if(this.ensureTouched(),null===this.theValue)throw new Error("Primitive value is null");return this.theValue}}var U=Object.defineProperty,X=(t,e,n)=>((t,e,n)=>e in t?U(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,"symbol"!=typeof e?e+"":e,n);function Y(t){return new Z(t)}class Z{constructor(t){this.$base=t,X(this,"resolver",t=>{this.lastV=t,this.resolvers.forEach(e=>{e(t)})}),X(this,"lastV"),X(this,"resolvers",new Set),X(this,"source"),n(t)&&(this.source=t)}then(e){return this.resolvers.add(e),1===this.resolvers.size?this.$base.then(this.resolver):t(this.lastV)&&e(this.lastV),this}use(t){return this.source?this.source.use(t):this.resolver(t),this}catch(t){return this.$base.catch(t),this}destroy(){return this.resolvers.clear(),this}value(){return N(this)}chain(t){return t.then(this.use.bind(this)),this}}function _(t){return Y(A(t))}function tt(t){const e=_();return H.transport.set(t,e.use.bind(e)),m((t,n)=>{e.catch(n),e.then(t)})}function et(t,e,n){const r=E(t);return m(function(t,s){r.catch(s),r.then(r=>{e(r)?t(r):void 0!==n&&t(n)})})}var nt=Object.defineProperty,rt=(t,e,n)=>((t,e,n)=>e in t?nt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,e+"",n);const st=Symbol("nothing");function ct(t){return new it(t)}class it{constructor(t){this.$base=t,rt(this,"$empty",_())}message(){return Y(this.$base).then(t=>{t===st&&this.$empty.use(!0)}),et(this.$base,t=>t!==st)}empty(){return this.$empty}}function ot(t,e){return m(function(n,r){t.catch(r),t.then(e(n))})}function ut(t,e){let n=null;return m(function(r,s){t.catch(s),t.then(t=>{null===n&&(n=t),r(n)}),e?.then(()=>{n=null})})}function ht(t,e,n,r){const s=E(t),c=E(e),i=E(n),o=E(r);return m((t,e)=>{s.catch(e),c.catch(e),i.catch(e),o.catch(e);let n=null;const r=t=>{n&&n(t)};return C(s,c,i).then(([e,s,c])=>{n=t,e?.[c]&&e[c](s,r)}),()=>{n=null,o&&C(s,c,o).then(([t,e,n])=>{t?.[n]?.(e,r)})}})}function at(t,n){const r=E(t);return m((t,s)=>{r.catch(s);const c=[],i=h();r.then(r=>{c.length=0,i.destroy(),r.forEach(t=>{let r=t;e(r)||(r=g(r));const s=n(r);i.add(s),c.push(s)}),C(...c).then(t)})})}function lt(t){return m((e,n)=>{let r=!1;t.catch(n),t.then(t=>{r||(r=!0,e(t))})})}function ft(t,e){return m((n,r)=>{const s=_(),c=h();return t.then(t=>{c.destroy();const n=e(t);c.add(n),s.chain(n),n.catch(r)}),t.catch(r),s.then(n),()=>{c.destroy()}})}function dt(t){return m((e,n)=>{const r=[];t.catch(n),t.then(t=>{r.push(t),e(r.slice())})})}function bt(t){const e=E(t);return m((t,n)=>{e.catch(n),e.then(e=>{e.forEach(e=>{t(e)})})})}export{E as ActualMessage,C as All,M as Any,k as Applied,L as AppliedDestructured,D as Catch,F as Chain,$ as Chainable,R as ChainableImpl,G as Computed,H as Context,I as ContextChain,tt as ContextOf,h as DestroyContainer,a as DestroyContainerImpl,c as Destroyable,i as DestroyableImpl,ct as Empty,it as EmptyImpl,ot as ExecutorApplied,et as Filtered,ut as Freeze,ht as FromEvent,A as Late,B as LateImpl,_ as LateShared,P as Local,at as Map,m as Message,j as MessageRx,O as MessageSource,S as MessageSourceImpl,z as New,st as Nothing,g as Of,lt as Once,N as Primitive,Q as PrimitiveImpl,ft as Process,d as Rejections,dt as Sequence,Y as Shared,Z as SharedImpl,b as Silence,bt as Stream,T as Void,y as ensureFunction,p as ensureMessage,r as isDestroyable,s as isDestroyed,t as isFilled,e as isMessage,n as isSource};
//# sourceMappingURL=silentium.min.mjs.map
