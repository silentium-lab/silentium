var t=Object.defineProperty,e=(e,n,r)=>((e,n,r)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r)(e,"symbol"!=typeof n?n+"":n,r);class n{constructor(){e(this,"catchers",[]),e(this,"lastRejectReason",null),e(this,"reject",(t=>{this.lastRejectReason=t,this.catchers.forEach((e=>{e(t)}))}))}catch(t){return null!==this.lastRejectReason&&t(this.lastRejectReason),this.catchers.push(t),this}destroy(){return this.catchers.length=0,this}}const r=t=>null!=t;function s(t){return null!==t&&"object"==typeof t&&"then"in t&&"function"==typeof t.then}function o(t){return null!==t&&"object"==typeof t&&"destroy"in t&&"function"==typeof t.destroy}function i(t){return null!==t&&"object"==typeof t&&"destroyed"in t&&"function"==typeof t.destroyed}function c(t,e){if("function"!=typeof t)throw new Error(`${e}: is not function`)}function u(t,e){if(!s(t))throw new Error(`${e}: is not message`)}var h=Object.defineProperty,a=(t,e,n)=>((t,e,n)=>e in t?h(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,"symbol"!=typeof e?e+"":e,n);function l(t){return new f(t)}class f{constructor(t){this.executor=t,a(this,"mbDestructor"),a(this,"rejections",new n),c(t,"Message: executor")}then(t){try{this.mbDestructor=this.executor(t,this.rejections.reject)}catch(t){this.rejections.reject(t)}return this}catch(t){return this.rejections.catch(t),this}destroy(){return"function"==typeof this.mbDestructor&&this.mbDestructor?.(),this.rejections.destroy(),this}}function d(t){return l((function(e){e(t)}))}function b(t){return s(t)?t:d(t)}function y(t){return new p(t)}class p{constructor(t){this.base=t}destroy(){return o(this.base)&&this.base.destroy(),this}}var w=Object.defineProperty,v=(t,e,n)=>((t,e,n)=>e in t?w(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,e+"",n);function j(){return new m}class m{constructor(){v(this,"destructors",[])}add(t){return o(t)&&this.destructors.push(t),t}destroy(){return this.destructors.forEach((t=>t.destroy())),this.destructors.length=0,this}}function g(t){const e=b(t);return l((function(t){let n=!1;return e.then((e=>{n||t(e)})),()=>{n=!0}}))}function E(t){return l((function(e){e(t())}))}function R(){return()=>{}}function V(...t){const e=t.map(b);return l((function(n){const r=new Set(Object.keys(t)),s=new Set,o=[];0!==r.size?e.map(((t,e)=>{t.then((t=>{var i,c;s.add(e.toString()),o[e]=t,c=r,(i=s).size>0&&i.size===c.size&&n(o)}))})):n([])}))}function P(...t){const e=t.map(b);return l((function(t){e.forEach((e=>{e.then(t)}))}))}function $(t,e){const n=b(t);return l((function(t){n.then((n=>{t(e(n))}))}))}function x(t,e){return $(t,(function(t){return e(...t)}))}var O=Object.defineProperty,z=(t,e,n)=>((t,e,n)=>e in t?O(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,"symbol"!=typeof e?e+"":e,n);function S(t){return new D(t)}class D{constructor(t){this.v=t,z(this,"rejections",new n),z(this,"lateR",null),z(this,"notify",(()=>{if(r(this.v)&&this.lateR)try{this.lateR(this.v)}catch(t){this.rejections.reject(t)}}))}then(t){if(this.lateR)throw new Error("Late component gets new resolver, when another was already connected!");return this.lateR=t,this.notify(),this}use(t){return this.v=t,this.notify(),this}catch(t){return this.rejections.catch(t),this}}function T(t){const e=new n;t.catch(e.reject);const r=S();return e.catch((t=>{r.use(t)})),r}function C(...t){const e=t.map(b);return l((function(t){let n;const r=s=>{const o=e[s],i=e[s+1];o.then((e=>{!function(e,s,o){s||(n=e);n&&t(n);s&&!n&&r(o+1)}(e,i,s)}))};r(0)}))}function M(t,e){return l((function(n){t.then(e(n))}))}function k(t,e,n){const r=b(t);return l((function(t){r.then((r=>{e(r)?t(r):void 0!==n&&t(n)}))}))}function L(t,e,n,r){const s=b(t),o=b(e),i=b(n),c=b(r);return l((t=>{let e=null;const n=t=>{e&&e(t)};return V(s,o,i).then((([r,s,o])=>{e=t,r?.[o]&&r[o](s,n)})),()=>{e=null,c&&V(s,o,c).then((([t,e,r])=>{t?.[r]?.(e,n)}))}}))}var W=Object.defineProperty,q=(t,e,n)=>((t,e,n)=>e in t?W(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,e+"",n);function A(t,e=null){return new B(t,e)}class B{constructor(t,e=null){this.$base=t,this.theValue=e,q(this,"touched",!1)}ensureTouched(){this.touched||this.$base.then((t=>{this.theValue=t})),this.touched=!0}[Symbol.toPrimitive](){return this.ensureTouched(),this.theValue}primitive(){return this.ensureTouched(),this.theValue}primitiveWithException(){if(this.ensureTouched(),null===this.theValue)throw new Error("Primitive value is null");return this.theValue}}var F=Object.defineProperty,G=(t,e,n)=>((t,e,n)=>e in t?F(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,"symbol"!=typeof e?e+"":e,n);function H(t,e){return new I(t,e)}class I{constructor(t,e){this.$base=t,this.source=e,G(this,"resolver",(t=>{this.lastV=t,this.resolvers.forEach((e=>{e(t)}))})),G(this,"lastV"),G(this,"resolvers",new Set)}then(t){return this.resolvers.add(t),1===this.resolvers.size?this.$base.then(this.resolver):r(this.lastV)&&t(this.lastV),this}use(t){return this.source?this.source.use(t):this.resolver(t),this}catch(t){return this.$base.catch(t),this}destroy(){return this.resolvers.clear(),this}value(){return A(this)}}function J(t){const e=S(t);return H(e,e)}function K(t,e){const n=b(t);return l((t=>{const r=[],o=j();n.then((n=>{o.destroy(),n.forEach((t=>{let n=t;s(n)||(n=d(n));const i=e(n);o.add(i),r.push(i)})),V(...r).then(t)}))}))}function N(t){return l((e=>{let n=!1;t.then((t=>{n||(n=!0,e(t))}))}))}function Q(t){const e=b(t);return l(((t,n)=>{e.then((e=>{const r=Q.transport.get(e.transport);if(void 0===r)throw new Error(`Context: unknown transport ${e.transport}`);e.result||(e.result=t),e.error||(e.error=n);try{r(e)}catch(t){n(t)}}))}))}function U(t){return e=>{if(!e.result)throw new Error("ContextChain did not find result in rpc message");b(t).then(e.result)}}function X(t){const e=J();return Q.transport.set(t,e.use.bind(e)),l((t=>{e.then(t)}))}function Y(t){return l((e=>{const n=[];t.then((t=>{n.push(t),e(n)}))}))}function Z(t){const e=b(t);return l((t=>{e.then((e=>{e.forEach((e=>{t(e)}))}))}))}Q.transport=new Map;export{b as ActualMessage,V as All,P as Any,$ as Applied,x as AppliedDestructured,T as Catch,C as Chain,Q as Context,U as ContextChain,X as ContextOf,j as DestroyContainer,m as DestroyContainerImpl,y as Destroyable,p as DestroyableImpl,M as ExecutorApplied,k as Filtered,L as FromEvent,S as Late,D as LateImpl,J as LateShared,g as Local,K as Map,l as Message,f as MessageRx,E as New,d as Of,N as Once,A as Primitive,B as PrimitiveImpl,Y as Sequence,H as Shared,I as SharedImpl,Z as Stream,R as Void,c as ensureFunction,u as ensureMessage,o as isDestroyable,i as isDestroyed,r as isFilled,s as isMessage};
//# sourceMappingURL=silentium.min.mjs.map
