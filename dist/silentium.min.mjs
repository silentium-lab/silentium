import{isEvent as e}from"src/helpers";const t=e=>null!=e;function s(e){return null!==e&&"object"==typeof e&&"event"in e&&"function"==typeof e.event}function r(e){return null!==e&&"object"==typeof e&&"destroy"in e&&"function"==typeof e.destroy}function i(e){return null!==e&&"object"==typeof e&&"use"in e&&"function"==typeof e.use}function n(e){return null!==e&&"object"==typeof e&&"of"in e&&"function"==typeof e.of}function h(e,t){if("function"!=typeof e)throw new Error(`${t}: is not function`)}function o(e,t){if(!s(e))throw new Error(`${t}: is not event`)}function a(e,t){if(!i(e))throw new Error(`${t}: is not user`)}var u=Object.defineProperty,l=(e,t,s)=>((e,t,s)=>t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class c{constructor(){l(this,"destructors",[])}add(e){return this.destructors.push(e),this}destroy(){return this.destructors.forEach((e=>e.destroy())),this}}var b=Object.defineProperty,v=(e,t,s)=>((e,t,s)=>t in e?b(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class d{constructor(e){this.eventExecutor=e,v(this,"mbDestructor"),h(e,"Event: eventExecutor")}event(e){return this.mbDestructor=this.eventExecutor(e),this}destroy(){return"function"==typeof this.mbDestructor&&this.mbDestructor?.(),this}}var f=Object.defineProperty,w=(e,t,s)=>((e,t,s)=>t in e?f(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);class p{constructor(e){this.$base=e,w(this,"destroyed",!1),w(this,"user",new P(((e,t)=>{this.destroyed||t.use(e)}))),o(e,"Local: $base")}event(e){return this.$base.event(this.user.child(e)),this}destroy(){return this}}class y{constructor(e){this.value=e}event(e){return e.use(this.value),this}}class ${use(){return this}}var m=Object.defineProperty,g=(e,t,s)=>((e,t,s)=>t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);class E{constructor(){g(this,"owners"),g(this,"innerOwner"),this.owners=new Set,this.innerOwner=new O((e=>{this.owners.forEach((t=>{t.use(e)}))}))}owner(){return this.innerOwner}size(){return this.owners.size}has(e){return this.owners.has(e)}add(e){return this.owners.add(e),this}remove(e){return this.owners.delete(e),this}destroy(){return this.owners.forEach((e=>{this.remove(e)})),this}}class O{constructor(e){this.userExecutor=e,h(e,"User: user executor")}use(e){return this.userExecutor(e),this}}class P{constructor(e,t=[],s){this.userExecutor=e,this.args=t,this.childUser=s,h(e,"ParentUser: executor")}use(e){if(void 0===this.childUser)throw new Error("no base user");return this.userExecutor(e,this.childUser,...this.args),this}child(e,...t){return new P(this.userExecutor,[...this.args,...t],e)}}var j=Object.defineProperty,U=(e,t,s)=>((e,t,s)=>t in e?j(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);class V{constructor(...e){U(this,"keysKnown"),U(this,"keysFilled",new Set),U(this,"$events"),U(this,"result",{}),U(this,"user",new P(((e,t,s)=>{var r,i;this.keysFilled.add(s),this.result[s]=e,r=this.keysFilled,i=this.keysKnown,r.size>0&&r.size===i.size&&t.use(Object.values(this.result))}))),this.keysKnown=new Set(Object.keys(e)),this.$events=e}event(e){return Object.entries(this.$events).forEach((([t,s])=>{o(s,"All: item"),this.keysKnown.add(t),s.event(this.user.child(e,t))})),this}}var x=Object.defineProperty,T=(e,t,s)=>((e,t,s)=>t in e?x(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class M{constructor(...e){T(this,"$events"),this.$events=e}event(e){return this.$events.forEach((t=>{o(t,"Any: item"),t.event(e)})),this}}var k=Object.defineProperty,F=(e,t,s)=>((e,t,s)=>t in e?k(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class A{constructor(e,t){this.$base=e,this.applier=t,F(this,"user",new P(((e,t)=>{t.use(this.applier(e))}))),o(e,"Applied: base")}event(e){return this.$base.event(this.user.child(e)),this}}class C{constructor(e,t,s){this.$base=e,this.errorMessage=t,this.errorOriginal=s,o(e,"Catch: base"),a(t,"Catch: errorMessage"),void 0!==s&&a(s,"Catch: errorOriginal")}event(e){try{this.$base.event(e)}catch(e){e instanceof Error?this.errorMessage.use(e.message):this.errorMessage.use(e),this.errorOriginal&&this.errorOriginal.use(e)}return this}}var z=Object.defineProperty,B=(e,t,s)=>((e,t,s)=>t in e?z(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);class D{constructor(...e){B(this,"$events"),B(this,"lastValue"),B(this,"handleEvent",((e,t)=>{const s=this.$events[e],r=this.$events[e+1];s.event(this.oneEventUser.child(t,r,e))})),B(this,"oneEventUser",new P(((e,t,s,r)=>{s||(this.lastValue=e),this.lastValue&&t.use(this.lastValue),s&&!this.lastValue&&this.handleEvent(r+1,t)}))),this.$events=e}event(e){return this.handleEvent(0,e),this}}class K{constructor(e,t){this.$base=e,this.applier=t,o(e,"ExecutorApplied: base")}event(e){const t=this.applier(e);return this.$base.event(t),this}}var S=Object.defineProperty,N=(e,t,s)=>((e,t,s)=>t in e?S(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class I{constructor(e,t,s){this.$base=e,this.predicate=t,this.defaultValue=s,N(this,"parent",new P(((e,t)=>{this.predicate(e)?t.use(e):void 0!==this.defaultValue&&t.use(this.defaultValue)})))}event(e){return this.$base.event(this.parent.child(e)),this}}var L=Object.defineProperty,W=(e,t,s)=>((e,t,s)=>t in e?L(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);class q{constructor(e,t,s,r){this.$emitter=e,this.$eventName=t,this.$subscribeMethod=s,this.$unsubscribeMethod=r,W(this,"lastUser",null),W(this,"handler",(e=>{this.lastUser&&this.lastUser.use(e)})),W(this,"parent",new P((([e,t,s],r)=>{this.lastUser=r,e?.[s]&&e[s](t,this.handler)})))}event(e){return new V(this.$emitter,this.$eventName,this.$subscribeMethod).event(this.parent.child(e)),this}destroy(){if(this.lastUser=null,!this.$unsubscribeMethod)return this;return new V(this.$emitter,this.$eventName,this.$unsubscribeMethod).event(new O((([e,t,s])=>{e?.[s]?.(t,this.handler)}))),this}}class G{constructor(e,t){this.p=e,this.errorOwner=t}event(e){return this.p.then((function(t){e.use(t)})).catch((e=>{this.errorOwner?.use(e)})),this}}var H=Object.defineProperty,J=(e,t,s)=>((e,t,s)=>t in e?H(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);class Q{constructor(e){this.v=e,J(this,"lateUser",null),J(this,"notify",(e=>{t(e)&&this.lateUser&&this.lateUser.use(e)}))}event(e){if(this.lateUser)throw new Error("Late component gets new user, when another was already connected!");return this.lateUser=e,this.notify(this.v),this}use(e){return this.notify(e),this}}var R=Object.defineProperty,X=(e,t,s)=>((e,t,s)=>t in e?R(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);class Y{constructor(e){this.$base=e,X(this,"isFilled",!1),X(this,"parent",new P(((e,t)=>{this.isFilled||(this.isFilled=!0,t.use(e))})))}event(e){return this.$base.event(this.parent.child(e)),this}}var Z=Object.defineProperty,_=(e,t,s)=>((e,t,s)=>t in e?Z(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);class ee{constructor(e,t=!1){this.$base=e,this.stateless=t,_(this,"ownersPool",new E),_(this,"lastValue"),_(this,"calls",new Q),_(this,"firstCall",new Y(this.calls).event(new O((()=>{this.$base.event(this.firstCallUser)})))),_(this,"firstCallUser",new O((e=>{this.lastValue=e,this.ownersPool.owner().use(e)})))}event(e){return this.calls.use(1),this.stateless||!t(this.lastValue)||this.ownersPool.has(e)||e.use(this.lastValue),this.ownersPool.add(e),this}use(e){return this.calls.use(1),this.lastValue=e,this.ownersPool.owner().use(e),this}touched(){this.calls.use(1)}pool(){return this.ownersPool}destroy(){return this.ownersPool.destroy()}}var te=Object.defineProperty,se=(e,t,s)=>((e,t,s)=>t in e?te(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class re{constructor(e,t=!1){this.$base=e,se(this,"$sharedBase"),this.$sharedBase=new ee(this.$base,t)}event(e){return this.$sharedBase.event(e),this}use(e){return this.$sharedBase.touched(),this.$base.use(e),this}}var ie=Object.defineProperty,ne=(e,t,s)=>((e,t,s)=>t in e?ie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class he{constructor(e){ne(this,"$event"),this.$event=new re(new Q(e))}event(e){return this.$event.event(e),this}use(e){return this.$event.use(e),this}}var oe=Object.defineProperty,ae=(e,t,s)=>((e,t,s)=>t in e?oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class ue{constructor(t,s){this.$base=t,this.$target=s,ae(this,"parent",new P(((t,s)=>{const r=[];t.forEach((t=>{let s=t;e(s)||(s=new y(s));const i=this.$target.of(s);r.push(i)}));new V(...r).event(s)})))}event(e){return this.$base.event(this.parent.child(e)),this}}var le=Object.defineProperty,ce=(e,t,s)=>((e,t,s)=>t in e?le(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class be{constructor(e,t=null){this.$base=e,this.theValue=t,ce(this,"touched",!1)}ensureTouched(){this.touched||this.$base.event(new O((e=>{this.theValue=e}))),this.touched=!0}[Symbol.toPrimitive](){return this.ensureTouched(),this.theValue}primitive(){return this.ensureTouched(),this.theValue}primitiveWithException(){if(this.ensureTouched(),null===this.theValue)throw new Error("Primitive value is null");return this.theValue}}var ve=Object.defineProperty,de=(e,t,s)=>((e,t,s)=>t in e?ve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);class fe{constructor(e){this.$base=e,de(this,"result",[]),de(this,"parent",new P(((e,t)=>{this.result.push(e),t.use(this.result)})))}event(e){return this.$base.event(this.parent.child(e)),this}}var we=Object.defineProperty,pe=(e,t,s)=>((e,t,s)=>t in e?we(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class ye{constructor(e){this.$base=e,pe(this,"parent",new P(((e,t)=>{e.forEach((e=>{t.use(e)}))})))}event(e){return this.$base.event(this.parent.child(e)),this}}class $e{constructor(e){this.executor=e}of(...e){return this.executor(...e)}}class me{constructor(e,t){this.baseTransport=e,this.applier=t}of(...e){return this.applier(this.baseTransport.of(...e))}}class ge{constructor(e,t,s=0){this.baseTransport=e,this.args=t,this.startFromArgIndex=s}of(...e){return this.baseTransport.of(...function(e,t,s){const r=e.slice(0,s);for(;r.length<s;)r.push(void 0);return r.concat(t)}(e,this.args,this.startFromArgIndex))}}var Ee=Object.defineProperty,Oe=(e,t,s)=>((e,t,s)=>t in e?Ee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class Pe{constructor(e){this.baseTransport=e,Oe(this,"destructors",[])}of(...e){const t=this.baseTransport.of(...e);return r(t)&&this.destructors.push(t),t}destroy(){return this.destructors.forEach((e=>e.destroy())),this}}export{V as All,M as Any,A as Applied,C as Catch,D as Chain,c as DestroyContainer,d as Event,K as ExecutorApplied,I as Filtered,q as FromEvent,G as FromPromise,Q as Late,he as LateShared,p as Local,ue as Map,y as Of,Y as Once,E as OwnerPool,P as ParentUser,be as Primitive,fe as Sequence,ee as Shared,re as SharedSource,ye as Stream,$e as Transport,me as TransportApplied,ge as TransportArgs,Pe as TransportDestroyable,O as User,$ as Void,o as ensureEvent,h as ensureFunction,a as ensureUser,r as isDestroyable,s as isEvent,t as isFilled,n as isTransport,i as isUser};
//# sourceMappingURL=silentium.min.mjs.map
