!function(n){"use strict";const t=(...n)=>{const t=new Set(Object.keys(n)),e=new Set;return function(o){const r={};Object.entries(n).forEach((([n,i])=>{t.add(n),i((function(i){e.add(n),r[n]=i,((n,t)=>n.size>0&&n.size===t.size)(e,t)&&o(Object.values(r))}))}))}},e=n=>null!=n;var o=Object.defineProperty,r=(n,t,e)=>((n,t,e)=>t in n?o(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e)(n,"symbol"!=typeof t?t+"":t,e);class i{constructor(){r(this,"owners"),r(this,"innerOwner"),this.owners=new Set,this.innerOwner=n=>{this.owners.forEach((t=>{t(n)}))}}owner(){return this.innerOwner}size(){return this.owners.size}has(n){return this.owners.has(n)}add(n){return this.owners.add(n),this}remove(n){return this.owners.delete(n),this}destroy(){return this.owners.forEach((n=>{this.remove(n)})),this}}const u=n=>{let t=null;const o=n=>{e(n)&&t&&t(n)};return{event:function(e){if(t)throw new Error("Late component gets new user, when another was already connected!");t=e,o(n)},use:function(n){o(n)}}},c=n=>function(t){let e=!1;n((function(n){e||(e=!0,t(n))}))},s=(n,t=!1)=>{const o=new i;let r;const s=u();return c(s.event)((function(){n((function(n){r=n,o.owner()(n)}))})),{event:function(n){return s.use(1),t||!e(r)||o.has(n)||n(r),o.add(n),()=>{o.remove(n)}},use:function(n){s.use(1),r=n,o.owner()(n)},touched(){s.use(1)},pool:()=>o,destroy(){o.destroy()}}},f=(n,t=!1)=>{const e=s(n.event,t);return{event:function(n){e.event(n)},use:function(t){e.touched(),n.use(t)}}};const l=n=>function(t){return t(n)};n.OwnerPool=i,n._void=()=>function(){},n.all=t,n.any=(...n)=>function(t){n.forEach((n=>{n(t)}))},n.applied=(n,t)=>function(e){n((function(n){e(t(n))}))},n.chain=(...n)=>function(t){let e;const o=r=>{const i=n[r],u=n[r+1];i((function(n){u||(e=n),e&&t(e),u&&!e&&o(r+1)}))};o(0)},n.constructorApplied=(n,t)=>function(...e){return t(n(...e))},n.constructorArgs=(n,t,e=0)=>function(...o){return n(...function(n,t,e){const o=n.slice(0,e);for(;o.length<e;)o.push(void 0);return o.concat(t)}(o,t,e))},n.constructorDestroyable=n=>{const t=[];return{get:function(...e){const o=n(...e);return t.push(o),o},destroy:function(){t.forEach((n=>n.destroy()))}}},n.destructor=(n,t)=>{let e,o=null;const r=()=>{o=null,e?.()};return{value:function(i){return o=i,e=n((n=>{o&&o(n)})),e&&t&&t(r),r},destroy:r}},n.executorApplied=(n,t)=>function(e){const o=t(e);n(o)},n.filtered=(n,t,e)=>function(o){n((function(n){t(n)?o(n):void 0!==e&&o(e)}))},n.fromEvent=(n,e,o,r)=>{let i=null;const u=function(n){i&&i(n)};return function(c){i=c;return t(n,e,o)((function([n,t,e]){n?.[e]&&n[e](t,u)})),function(){if(i=null,!r)return;t(n,e,r)((([n,t,e])=>{n?.[e]?.(t,u)}))}}},n.fromPromise=(n,t)=>function(e){n.then((function(n){e(n)})).catch((function(n){t?.(n)}))},n.isFilled=e,n.late=u,n.lateShared=n=>f(u(n)),n.local=n=>function(t){let e=!1;const o=n((function(n){e||t(n)}));return()=>{e=!0,o?.()}},n.map=(n,e)=>function(o){n((function(n){const r=[];n.forEach((n=>{let t=n;"function"!=typeof t&&(t=l(t));const o=e(t);r.push(o)}));t(...r)(o)}))},n.of=l,n.on=(n,t)=>n(t),n.once=c,n.primitive=(n,t=null)=>(n((function(n){t=n})),{[Symbol.toPrimitive]:()=>t,primitive:()=>t,primitiveWithException(){if(null===t)throw new Error("Primitive value is null");return t}}),n.sequence=n=>function(t){const e=[];n((function(n){e.push(n),t(e)}))},n.shared=s,n.sharedSource=f,n.stream=n=>function(t){n((function(n){n.forEach((n=>{t(n)}))}))}}({});
