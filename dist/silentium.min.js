var silentium=function(e){"use strict";function t(e){return new s(e)}class s{constructor(e){this.value=e}pipe(e){return e.use(this.value),this}}const r=e=>null!=e;function i(e){return null!==e&&"object"==typeof e&&"pipe"in e&&"function"==typeof e.pipe}function n(e){return null!==e&&"object"==typeof e&&"destroy"in e&&"function"==typeof e.destroy}function a(e){return null!==e&&"object"==typeof e&&"destroyed"in e&&"function"==typeof e.destroyed}function u(e){return null!==e&&"object"==typeof e&&"use"in e&&"function"==typeof e.use}function o(e){return i(e)?e:t(e)}class h{constructor(e){this.base=e}destroy(){return n(this.base)&&this.base.destroy(),this}}var l=Object.defineProperty,c=(e,t,s)=>((e,t,s)=>t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class p{constructor(){c(this,"destructors",[])}add(e){return n(e)&&this.destructors.push(e),e}destroy(){return this.destructors.forEach((e=>e.destroy())),this.destructors.length=0,this}}function b(e,t){if("function"!=typeof e)throw new Error(`${t}: is not function`)}function f(e,t){if(!i(e))throw new Error(`${t}: is not message`)}function d(e,t){if(!u(e))throw new Error(`${t}: is not tap`)}function m(e){return new y(e)}class y{constructor(e){this.executor=e,b(e,"Tap: tap executor")}use(e){return this.executor(e),this}}class w{constructor(e){this.executor=e,b(e,"TapMessage: tap executor")}use(e){return this.executor(e)}}function g(e,...t){return new $(e,t)}class ${constructor(e,t=[],s){this.executor=e,this.args=t,this._child=s,b(e,"TapParent: executor")}use(e){if(void 0===this._child)throw new Error("no base tap");return this.executor.call(this._child,e,...this.args),this}child(e,...t){return new $(this.executor,[...this.args,...t],e)}}var v=Object.defineProperty,T=(e,t,s)=>((e,t,s)=>t in e?v(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);class P{constructor(e){this.$base=e,T(this,"destroyed",!1),T(this,"tap",g((function(e,t){t.destroyed||this.use(e)}),this)),f(e,"Local: $base")}pipe(e){return this.$base.pipe(this.tap.child(e)),this}destroy(){return this.destroyed=!0,this}}var I=Object.defineProperty,O=(e,t,s)=>((e,t,s)=>t in e?I(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);function j(e){return new M(e)}class M{constructor(e){this.executor=e,O(this,"mbDestructor"),b(e,"Message: executor")}pipe(e){return this.mbDestructor=this.executor.call(e,e),this}destroy(){return"function"==typeof this.mbDestructor&&this.mbDestructor?.(),this}}class E{constructor(e){this.base=e}wait(e){return void 0!==this.base&&e.pipe(this.base),this}}class A{use(){return this}}var x=Object.defineProperty,C=(e,t,s)=>((e,t,s)=>t in e?x(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);function S(...e){return new V(...e)}class V{constructor(...e){C(this,"known"),C(this,"filled",new Set),C(this,"$messages"),C(this,"result",[]),C(this,"tap",g((function(e,t,s){var r,i;t.filled.add(s),t.result[parseInt(s)]=e,r=t.filled,i=t.known,r.size>0&&r.size===i.size&&this.use(t.result)}),this)),this.known=new Set(Object.keys(e)),this.$messages=e.map(o)}pipe(e){return Object.entries(this.$messages).forEach((([t,s])=>{f(s,"All: item"),s.pipe(this.tap.child(e,t))})),0===this.known.size&&e.use([]),this}}var D=Object.defineProperty,F=(e,t,s)=>((e,t,s)=>t in e?D(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class L{constructor(...e){F(this,"$messages"),this.$messages=e}pipe(e){return this.$messages.forEach((t=>{f(t,"Any: item"),t.pipe(e)})),this}}var z=Object.defineProperty,R=(e,t,s)=>((e,t,s)=>t in e?z(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);function k(e,t){return new B(o(e),t)}class B{constructor(e,t){this.$base=e,this.applier=t,R(this,"tap",g((function(e,t){this.use(t.applier(e))}),this)),f(e,"Applied: base")}pipe(e){return this.$base.pipe(this.tap.child(e)),this}}class N{constructor(e,t,s){this.$base=e,this.errorMessage=t,this.errorOriginal=s,f(e,"Catch: base"),d(t,"Catch: errorMessage"),void 0!==s&&d(s,"Catch: errorOriginal")}pipe(e){try{this.$base.pipe(e)}catch(e){e instanceof Error?this.errorMessage.use(e.message):this.errorMessage.use(String(e)),this.errorOriginal&&this.errorOriginal.use(e)}return this}}var _=Object.defineProperty,q=(e,t,s)=>((e,t,s)=>t in e?_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);class W{constructor(...e){q(this,"$messages"),q(this,"$latest"),q(this,"handleMessage",((e,t)=>{const s=this.$messages[e],r=this.$messages[e+1];s.pipe(this.oneMessageTap.child(t,r,e))})),q(this,"oneMessageTap",g((function(e,t,s,r){s||(t.$latest=e),t.$latest&&this.use(t.$latest),s&&!t.$latest&&t.handleMessage(r+1,this)}),this)),this.$messages=e}pipe(e){return this.handleMessage(0,e),this}}class G{constructor(e,t){this.$base=e,this.applier=t,f(e,"ExecutorApplied: base")}pipe(e){return this.$base.pipe(m(this.applier(e.use.bind(e)))),this}}var H=Object.defineProperty,J=(e,t,s)=>((e,t,s)=>t in e?H(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class K{constructor(e,t,s){this.$base=e,this.predicate=t,this.defaultValue=s,J(this,"parent",g((function(e,t){t.predicate(e)?this.use(e):void 0!==t.defaultValue&&this.use(t.defaultValue)}),this))}pipe(e){return this.$base.pipe(this.parent.child(e)),this}}var Q=Object.defineProperty,U=(e,t,s)=>((e,t,s)=>t in e?Q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);class X{constructor(e,t,s,r){this.$emitter=e,this.$eventName=t,this.$subscribeMethod=s,this.$unsubscribeMethod=r,U(this,"lastTap",null),U(this,"handler",(e=>{this.lastTap&&this.lastTap.use(e)})),U(this,"parent",g((function([e,t,s],r){r.lastTap=this,e?.[s]&&e[s](t,r.handler)}),this))}pipe(e){return S(this.$emitter,this.$eventName,this.$subscribeMethod).pipe(this.parent.child(e)),this}destroy(){return this.lastTap=null,this.$unsubscribeMethod?(S(this.$emitter,this.$eventName,this.$unsubscribeMethod).pipe(m((([e,t,s])=>{e?.[s]?.(t,this.handler)}))),this):this}}class Y{constructor(e,t){this.p=e,this.error=t}pipe(e){return this.p.then((t=>{e.use(t)})).catch((e=>{this.error?.use(e)})),this}}var Z=Object.defineProperty,ee=(e,t,s)=>((e,t,s)=>t in e?Z(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);function te(e){return new se(e)}class se{constructor(e){this.v=e,ee(this,"lateTap",null),ee(this,"notify",(e=>{r(e)&&this.lateTap&&this.lateTap.use(e)}))}pipe(e){if(this.lateTap)throw new Error("Late component gets new tap, when another was already connected!");return this.lateTap=e,this.notify(this.v),this}use(e){return this.notify(e),this}}var re=Object.defineProperty,ie=(e,t,s)=>((e,t,s)=>t in e?re(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);function ne(e){return new ae(e)}class ae{constructor(e){this.$base=e,ie(this,"isFilled",!1),ie(this,"parent",g((function(e,t){t.isFilled||(t.isFilled=!0,this.use(e))}),this))}pipe(e){return this.$base.pipe(this.parent.child(e)),this}}var ue=Object.defineProperty,oe=(e,t,s)=>((e,t,s)=>t in e?ue(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);class he{constructor(){oe(this,"taps"),oe(this,"innerTap"),this.taps=new Set,this.innerTap=m((e=>{this.taps.forEach((t=>{a(t)&&t.destroyed()?this.taps.delete(t):t.use(e)}))}))}tap(){return this.innerTap}size(){return this.taps.size}has(e){return this.taps.has(e)}add(e){return this.taps.add(e),this}remove(e){return this.taps.delete(e),this}destroy(){return this.taps.forEach((e=>{this.remove(e)})),this}}var le=Object.defineProperty,ce=(e,t,s)=>((e,t,s)=>t in e?le(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);function pe(e,t=!1){return new be(e,t)}class be{constructor(e,t=!1){this.$base=e,this.stateless=t,ce(this,"tapPool",new he),ce(this,"lastValue"),ce(this,"calls",te()),ce(this,"firstCallTap",m((e=>{this.lastValue=e,this.tapPool.tap().use(e)}))),ne(this.calls).pipe(m((()=>{this.$base.pipe(this.firstCallTap)})))}pipe(e){return this.calls.use(1),this.stateless||!r(this.lastValue)||this.tapPool.has(e)||e.use(this.lastValue),this.tapPool.add(e),this}use(e){return this.calls.use(1),this.lastValue=e,this.tapPool.tap().use(e),this}touched(){this.calls.use(1)}pool(){return this.tapPool}destroy(){return this.tapPool.destroy()}}var fe=Object.defineProperty,de=(e,t,s)=>((e,t,s)=>t in e?fe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);function me(e,t=!1){return new ye(e,t)}class ye{constructor(e,t=!1){this.$base=e,de(this,"$sharedBase"),this.$sharedBase=pe(this.$base,t)}pipe(e){return this.$sharedBase.pipe(e),this}use(e){return this.$sharedBase.touched(),this.$base.use(e),this}}var we=Object.defineProperty,ge=(e,t,s)=>((e,t,s)=>t in e?we(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);function $e(e,t=null){return new ve(e,t)}class ve{constructor(e,t=null){this.$base=e,this.theValue=t,ge(this,"touched",!1)}ensureTouched(){this.touched||this.$base.pipe(m((e=>{this.theValue=e}))),this.touched=!0}[Symbol.toPrimitive](){return this.ensureTouched(),this.theValue}primitive(){return this.ensureTouched(),this.theValue}primitiveWithException(){if(this.ensureTouched(),null===this.theValue)throw new Error("Primitive value is null");return this.theValue}}var Te=Object.defineProperty,Pe=(e,t,s)=>((e,t,s)=>t in e?Te(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);function Ie(e){return new Oe(e)}class Oe{constructor(e){Pe(this,"$msg"),Pe(this,"primitive"),this.$msg=me(te(e)),this.primitive=$e(this,e)}pipe(e){return this.$msg.pipe(e),this}use(e){return this.$msg.use(e),this}value(){return this.primitive}}var je=Object.defineProperty,Me=(e,t,s)=>((e,t,s)=>t in e?je(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class Ee{constructor(e,s){this.$base=e,this.$target=s,Me(this,"parent",g((function(e,s){const r=[];e.forEach((e=>{let n=e;i(n)||(n=t(n));const a=s.$target.use(n);r.push(a)})),S(...r).pipe(this)}),this))}pipe(e){return this.$base.pipe(this.parent.child(e)),this}}var Ae=Object.defineProperty,xe=(e,t,s)=>((e,t,s)=>t in e?Ae(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);function Ce(e){return new Se(o(e))}Ce.tap={};class Se{constructor(e){this.$rpc=e,xe(this,"$result",Ie()),xe(this,"$error",Ie())}result(){return this.$rpc.pipe(m((e=>{const t=void 0===e.tap?Ce.tap.default:Ce.tap[e.tap]||Ce.tap.default;if(!t)throw new Error(`RPCImpl: Tap not found ${e.tap}`);e.result||(e.result=this.$result),e.error||(e.error=this.$error),t.use(e)}))),this.$result}error(){return this.$error}}var Ve=Object.defineProperty,De=(e,t,s)=>((e,t,s)=>t in e?Ve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);class Fe{constructor(e){this.$base=e,De(this,"result",[]),De(this,"parent",g((function(e,t){t.result.push(e),this.use(t.result)}),this))}pipe(e){return this.$base.pipe(this.parent.child(e)),this}}var Le=Object.defineProperty,ze=(e,t,s)=>((e,t,s)=>t in e?Le(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class Re{constructor(e){this.$base=e,ze(this,"parent",g((function(e){e.forEach((e=>{this.use(e)}))})))}pipe(e){return this.$base.pipe(this.parent.child(e)),this}}class ke{constructor(e,t){this.baseTap=e,this.applier=t}use(e){return this.applier(this.baseTap.use(e))}}class Be{constructor(e,t,s=0){this.baseTap=e,this.args=t,this.startFromArgIndex=s}use(e){return this.baseTap.use(function(e,t,s){const r=e.slice(0,s);for(;r.length<s;)r.push(void 0);return r.concat(t)}(e,this.args,this.startFromArgIndex))}}var Ne=Object.defineProperty,_e=(e,t,s)=>((e,t,s)=>t in e?Ne(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class qe{constructor(e){this.baseTap=e,_e(this,"destructors",[])}use(e){const t=this.baseTap.use(e);return n(t)&&this.destructors.push(t),t}destroy(){return this.destructors.forEach((e=>e.destroy())),this}}return e.ActualMessage=o,e.All=S,e.AllImpl=V,e.Any=function(...e){return new L(...e.map(o))},e.AnyImpl=L,e.Applied=k,e.AppliedDestructured=function(e,t){return k(e,(e=>t(...e)))},e.AppliedImpl=B,e.Catch=function(e,t,s){return new N(e,t,s)},e.CatchImpl=N,e.Chain=function(...e){return new W(...e)},e.ChainImpl=W,e.DestroyContainer=function(){return new p},e.DestroyContainerImpl=p,e.Destroyable=function(e){return new h(e)},e.DestroyableImpl=h,e.ExecutorApplied=function(e,t){return new G(e,t)},e.ExecutorAppliedImpl=G,e.Filtered=function(e,t,s){return new K(o(e),t,s)},e.FilteredImpl=K,e.FromEvent=function(e,t,s,r){return new X(o(e),o(t),o(s),o(r))},e.FromEventImpl=X,e.FromPromise=function(e,t){return new Y(e,t)},e.FromPromiseImpl=Y,e.Late=te,e.LateImpl=se,e.LateShared=Ie,e.LateSharedImpl=Oe,e.Local=function(e){return new P(o(e))},e.LocalImpl=P,e.Map=function(e,t){return new Ee(o(e),t)},e.MapImpl=Ee,e.Message=j,e.MessageImpl=M,e.New=function(e){return j((t=>{t.use(e())}))},e.Of=t,e.OfImpl=s,e.Once=ne,e.OnceImpl=ae,e.Primitive=$e,e.PrimitiveImpl=ve,e.RPC=Ce,e.RPCChain=function(e){return m((t=>{if(!t.result)throw new Error("RPCChain did not find result in rpc message");o(e).pipe(t.result)}))},e.RPCImpl=Se,e.RPCOf=function(e){const t=Ie();return Ce.tap[e]=t,j((e=>{t.pipe(e)}))},e.Sequence=function(e){return new Fe(e)},e.SequenceImpl=Fe,e.Shared=pe,e.SharedImpl=be,e.SharedSource=me,e.SharedSourceImpl=ye,e.Stream=function(e){return new Re(o(e))},e.StreamImpl=Re,e.Tap=m,e.TapApplied=function(e,t){return new ke(e,t)},e.TapAppliedImpl=ke,e.TapArgs=function(e,t,s=0){return new Be(e,t,s)},e.TapArgsImpl=Be,e.TapDestroyable=function(e){return new qe(e)},e.TapDestroyableImpl=qe,e.TapImpl=y,e.TapMessage=function(e){return new w(e)},e.TapMessageImpl=w,e.TapOptional=function(e){return new E(e)},e.TapOptionalImpl=E,e.TapParent=g,e.TapParentImpl=$,e.TapPool=he,e.Void=function(){return new A},e.VoidImpl=A,e.ensureFunction=b,e.ensureMessage=f,e.ensureTap=d,e.isDestroyable=n,e.isDestroyed=a,e.isFilled=r,e.isMessage=i,e.isTap=u,e}({});
