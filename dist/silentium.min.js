!function(n){"use strict";function t(...n){const t=new Set(Object.keys(n)),e=new Set;return function(r){const o={};Object.entries(n).forEach((([n,u])=>{t.add(n),u((function(u){e.add(n),o[n]=u,((n,t)=>n.size>0&&n.size===t.size)(e,t)&&r(Object.values(o))}))}))}}const e=n=>null!=n;var r=Object.defineProperty,o=(n,t,e)=>((n,t,e)=>t in n?r(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e)(n,"symbol"!=typeof t?t+"":t,e);class u{constructor(){o(this,"owners"),o(this,"innerOwner"),this.owners=new Set,this.innerOwner=n=>{this.owners.forEach((t=>{t(n)}))}}owner(){return this.innerOwner}size(){return this.owners.size}has(n){return this.owners.has(n)}add(n){return this.owners.add(n),this}remove(n){return this.owners.delete(n),this}destroy(){return this.owners.forEach((n=>{this.remove(n)})),this}}function i(n){let t=null;const r=n=>{e(n)&&t&&t(n)};return{event:function(e){if(t)throw new Error("Late component gets new user, when another was already connected!");t=e,r(n)},use:function(n){r(n)}}}function c(n){return function(t){let e=!1;n((function(n){e||(e=!0,t(n))}))}}function s(n,t=!1){const r=new u;let o;const s=i();return c(s.event)((function(){n((function(n){o=n,r.owner()(n)}))})),{event:function(n){return s.use(1),t||!e(o)||r.has(n)||n(o),r.add(n),()=>{r.remove(n)}},use:function(n){s.use(1),o=n,r.owner()(n)},touched(){s.use(1)},pool:()=>r,destroy(){r.destroy()}}}function f(n,t=!1){const e=s(n.event,t);return{event:function(n){e.event(n)},use:function(t){e.touched(),n.use(t)}}}function l(n,t){let e,r=null;const o=()=>{r=null,e?.()};return{event:function(u){return r=new WeakRef(u),e=n((n=>{r&&r.deref()?.(n)})),e&&t&&t(o),o},destroy:o}}function h(n){return function(t){return t(n)}}n.All=t,n.Any=function(...n){return function(t){n.forEach((n=>{n(t)}))}},n.Applied=function(n,t){return function(e){n((function(n){e(t(n))}))}},n.Chain=function(...n){return function(t){let e;const r=o=>{const u=n[o],i=n[o+1];u((function(n){i||(e=n),e&&t(e),i&&!e&&r(o+1)}))};r(0)}},n.ConstructorApplied=function(n,t){return function(...e){return t(n(...e))}},n.ConstructorArgs=function(n,t,e=0){return function(...r){return n(...function(n,t,e){const r=n.slice(0,e);for(;r.length<e;)r.push(void 0);return r.concat(t)}(r,t,e))}},n.ConstructorDestroyable=function(n){const t=[];return{get:function(...e){const r=n(...e);return n=>{if("destroy"in r)t.push(r.destroy),r.event(n);else{const e=r(n);e&&t.push(e)}return()=>{t.forEach((n=>n()))}}},destroy:function(){t.forEach((n=>n()))}}},n.DestroyContainer=function(){const n=[];return{add(t){const e=l(t);return n.push(e.destroy),e.event},destroy(){n.forEach((n=>n()))}}},n.Destructor=l,n.ExecutorApplied=function(n,t){return function(e){const r=t(e);n(r)}},n.Filtered=function(n,t,e){return function(r){n((function(n){t(n)?r(n):void 0!==e&&r(e)}))}},n.FromEvent=function(n,e,r,o){let u=null;const i=function(n){u&&u(n)};return function(c){u=c;return t(n,e,r)((function([n,t,e]){n?.[e]&&n[e](t,i)})),function(){if(u=null,!o)return;t(n,e,o)((([n,t,e])=>{n?.[e]?.(t,i)}))}}},n.FromPromise=function(n,t){return function(e){n.then((function(n){e(n)})).catch((function(n){t?.(n)}))}},n.Late=i,n.LateShared=function(n){return f(i(n))},n.Local=function(n){return function(t){let e=!1;const r=n((function(n){e||t(n)}));return()=>{e=!0,r?.()}}},n.Map=function(n,e){return function(r){n((function(n){const o=[];n.forEach((n=>{let t=n;"function"!=typeof t&&(t=h(t));const r=e(t);o.push(r)}));t(...o)(r)}))}},n.Of=h,n.On=function(n,t){return n(t)},n.Once=c,n.OwnerPool=u,n.Primitive=function(n,t=null){return n((function(n){t=n})),{[Symbol.toPrimitive]:()=>t,primitive:()=>t,primitiveWithException(){if(null===t)throw new Error("Primitive value is null");return t}}},n.Sequence=function(n){return function(t){const e=[];n((function(n){e.push(n),t(e)}))}},n.Shared=s,n.SharedSource=f,n.Stream=function(n){return function(t){n((function(n){n.forEach((n=>{t(n)}))}))}},n.Void=function(){return function(){}},n.isFilled=e}({});
