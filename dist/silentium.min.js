!function(e){"use strict";var t=Object.defineProperty,s=(e,s,r)=>((e,s,r)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[s]=r)(e,"symbol"!=typeof s?s+"":s,r);const r=class e{constructor(...t){s(this,"theDeps"),s(this,"name"),this.theDeps=t??[],e.instanceCount+=1,this.name=this.constructor.name+"_"+e.instanceCount,e.instancesHashMap[this.name]=1}destroy(){return delete e.instancesHashMap[this.name],this.theDeps?.forEach((t=>{(e=>"object"==typeof e&&null!==e&&"destroy"in e)(t)?t.destroy():delete e.instancesHashMap[this.name]})),this}addDep(e){return this.theDeps?.push(e),this}dep(e){return this.addDep(e),e}static getInstancesCount(){return Object.keys(e.instancesHashMap).length}};s(r,"instanceCount",0),s(r,"instancesHashMap",{});let i=r;class n extends i{constructor(e){super(),this.destructor=e}destroy(){return this.destructor(),this}}class a{}class h extends a{constructor(e){super(),this.fn=e}give(e){return this.fn(e),this}}var u=Object.defineProperty,o=(e,t,s)=>((e,t,s)=>t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class l extends i{}const c=e=>null!=e;var d=Object.defineProperty,v=(e,t,s)=>((e,t,s)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);class b{constructor(){v(this,"owners"),v(this,"innerOwner"),this.owners=new Set,this.innerOwner=new h((e=>{this.owners.forEach((t=>{t.give(e)}))}))}owner(){return this.innerOwner}size(){return this.owners.size}has(e){return this.owners.has(e)}add(e){return this.owners.add(e),this}remove(e){return this.owners.delete(e),this}destroy(){return this.owners.forEach((e=>{this.remove(e)})),this}}class p extends l{constructor(e){super(e),this.theValue=e}value(e){return c(this.theValue)&&e.give(this.theValue),this}}class w extends i{constructor(e){super(),this.buildFn=e}get(...e){return e.forEach((e=>{this.addDep(e)})),this.buildFn?.(...e)??new p(null)}}var f=Object.defineProperty,y=(e,t,s)=>((e,t,s)=>t in e?f(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class g extends l{constructor(e){super(e),this.valueFn=e,y(this,"mbDestructor")}value(e){return this.mbDestructor=this.valueFn(e),this}destroy(){return super.destroy(),this.mbDestructor?.(),this}}class m extends a{give(){return this}}var S=Object.defineProperty,O=(e,t,s)=>((e,t,s)=>t in e?S(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);class x extends l{constructor(...e){super(...e),O(this,"keysKnown"),O(this,"keysFilled",new Set),O(this,"infos"),this.infos=e,this.keysKnown=new Set(Object.keys(e))}value(e){const t={};return Object.entries(this.infos).forEach((([s,r])=>{this.keysKnown.add(s),r.value(new h((r=>{this.keysFilled.add(s),t[s]=r,this.isAllFilled()&&e.give(Object.values(t))})))})),this}isAllFilled(){return this.keysFilled.size>0&&this.keysFilled.size===this.keysKnown.size}}var P=Object.defineProperty,V=(e,t,s)=>((e,t,s)=>t in e?P(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);var F=Object.defineProperty,j=(e,t,s)=>((e,t,s)=>t in e?F(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);var D=Object.defineProperty,E=(e,t,s)=>((e,t,s)=>t in e?D(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);var k=Object.defineProperty,M=(e,t,s)=>((e,t,s)=>t in e?k(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);class z extends l{constructor(e){super(e),this.theValue=e,M(this,"theOwner"),M(this,"lateOwner",new h((e=>{this.theValue=e,this.notify()})))}value(e){if(this.theOwner)throw new Error("Late component gets new owner, when another was already connected!");return this.theOwner=e,this.notify(),this}give(e){return this.theValue=e,this.lateOwner.give(e),this}notify(){return c(this.theValue)&&this.theOwner&&this.theOwner.give(this.theValue),this}}var A=Object.defineProperty,C=(e,t,s)=>((e,t,s)=>t in e?A(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);class L extends l{constructor(e,t=!1){super(e),this.baseSrc=e,this.stateless=t,C(this,"lastValue"),C(this,"ownersPool",new b),this.addDep(this.ownersPool),this.baseSrc.value(new h((e=>{this.ownersPool.owner().give(e),this.lastValue=e})))}value(e){const t=new g((e=>(this.stateless||!c(this.lastValue)||this.ownersPool.has(e)||e.give(this.lastValue),this.ownersPool.add(e),()=>{this.ownersPool.remove(e)})));return t.value(e),this.addDep(t),this}pool(){return this.ownersPool}give(e){return this.lastValue=e,this.ownersPool.owner().give(e),this}}var I=Object.defineProperty,H=(e,t,s)=>((e,t,s)=>t in e?I(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class K extends l{constructor(e,t=!1){const s=new L(e,t);super(s),this.baseSrc=e,H(this,"sharedSrc"),this.sharedSrc=s}value(e){return this.sharedSrc.value(e),this}give(e){return this.baseSrc.give(e),this}}var N=Object.defineProperty,T=(e,t,s)=>((e,t,s)=>t in e?N(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,t+"",s);class q{constructor(e,t=null){this.theValue=t,e.value(new h((e=>{this.theValue=e})))}[Symbol.toPrimitive](){return this.theValue}}e.All=x,e.Any=class extends l{constructor(...e){super(...e),V(this,"infos"),this.infos=e}value(e){return this.infos.forEach((t=>{t.value(e)})),this}},e.Applied=class extends l{constructor(e,t){super(e),this.baseSrc=e,this.applier=t}value(e){return this.baseSrc.value(new h((t=>{e.give(this.applier(t))}))),this}},e.Chain=class extends l{constructor(...e){super(...e),j(this,"theInfos"),this.theInfos=e}value(e){let t;const s=r=>{const i=this.theInfos[r],n=this.theInfos[r+1];i.value(new h((i=>{n||(t=i),t&&e.give(t),n&&!t&&s(r+1)})))};return s(0),this}},e.DestroyFunc=n,e.Destroyable=i,e.ExecutorApplied=class extends l{constructor(e,t){super(e),this.baseSrc=e,this.applier=t}value(e){return this.baseSrc.value(new h(this.applier((t=>{e.give(t)})))),this}},e.Filtered=class extends l{constructor(e,t,s){super(e),this.baseSrc=e,this.predicate=t,this.defaultValue=s}value(e){return this.baseSrc.value(new h((t=>{this.predicate(t)?e.give(t):void 0!==this.defaultValue&&e.give(this.defaultValue)}))),this}},e.From=h,e.FromCallback=class extends l{constructor(e,...t){super(e),this.waitForCb=e,E(this,"theArgs"),this.theArgs=t}value(e){return this.waitForCb((t=>{e.give(t)}),...this.theArgs),this}},e.FromEvent=class extends l{constructor(e,t,s,r=new p("")){super(e,t,s,r),this.emitterSrc=e,this.eventNameSrc=t,this.subscribeMethodSrc=s,this.unsubscribeMethodSrc=r}value(e){const t=new x(this.emitterSrc,this.eventNameSrc,this.subscribeMethodSrc,this.unsubscribeMethodSrc),s=t=>{e.give(t)};return t.value(new h((([e,t,r,i])=>{e?.[r]&&(e[r](t,s),this.addDep(new n((()=>{e[i](t,s)}))))}))),this}},e.FromPromise=class extends l{constructor(e,t){super(e),this.p=e,this.errorOwner=t}value(e){return this.p.then((t=>{e.give(t)})).catch((e=>{this.errorOwner?.give(e)})),this}},e.Late=z,e.LateShared=class extends l{constructor(e){super(e),this.theValue=e,T(this,"src"),this.src=new K(new z(e))}value(e){return this.src.value(e),this}give(e){return this.src.give(e),this}},e.Lazy=w,e.LazyApplied=class extends w{constructor(e,t){super(),this.baseLazy=e,this.applier=t}get(...e){return this.applier(this.baseLazy.get(...e))}},e.LazyClass=class extends w{constructor(e){super(((...t)=>new e(...t)))}},e.Map=class extends l{constructor(e,t){super(e,t),this.baseSrc=e,this.targetSrc=t}value(e){const t=[];return this.baseSrc.value(new h((s=>{t.forEach((e=>{e?.destroy()})),t.length=0,s.forEach((e=>{let s=e;s instanceof l||(s=new p(s));const r=this.targetSrc.get(s);t.push(r)}));new x(...t).value(e)}))),this}},e.MbInfo=class extends l{constructor(e){const t="object"==typeof e&&null!==e&&"value"in e&&"function"==typeof e.value?e:new p(e);super(t),o(this,"info"),this.info=t}value(e){return this.info.value(e),this}},e.Of=p,e.OfFunc=g,e.On=class extends i{constructor(e,t){super(e,t),e.value(t?new h(t):new m)}},e.Once=class extends l{constructor(e){super(),this.baseSrc=e}value(e){let t=!1;return this.baseSrc.value(new h((s=>{t||(t=!0,e.give(s))}))),this}},e.OwnerPool=b,e.PrimitiveSource=q,e.Sequence=class extends l{constructor(e){super(e),this.baseSrc=e}value(e){const t=[];return this.baseSrc.value(new h((s=>{t.push(s),e.give(t)}))),this}},e.Shared=L,e.SharedSource=K,e.Stream=class extends l{constructor(e){super(e),this.baseSrc=e}value(e){return this.baseSrc.value(new h((t=>{t.forEach((t=>{e.give(t)}))}))),this}},e.TheInformation=l,e.TheOwner=a,e.Void=m,e.isFilled=c}({});
